<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to R - 1&nbsp; The R Environment</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./notes.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The <strong><span class="sans-serif">R</span></strong> <em>Environment</em></span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to R</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notes.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The <strong><span class="sans-serif">R</span></strong> <em>Environment</em></span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#why-are-there-so-many-users" id="toc-why-are-there-so-many-users" class="nav-link active" data-scroll-target="#why-are-there-so-many-users"><span class="header-section-number">1.1</span> Why Are There So Many Use<strong><span class="sans-serif">R</span></strong>s?</a>
  <ul class="collapse">
  <li><a href="#statistical-tools" id="toc-statistical-tools" class="nav-link" data-scroll-target="#statistical-tools"><span class="header-section-number">1.1.1</span> Statistical Tools</a></li>
  <li><a href="#graphics" id="toc-graphics" class="nav-link" data-scroll-target="#graphics"><span class="header-section-number">1.1.2</span> Graphics</a></li>
  <li><a href="#extensibility" id="toc-extensibility" class="nav-link" data-scroll-target="#extensibility"><span class="header-section-number">1.1.3</span> Extensibility</a></li>
  <li><a href="#cost-0" id="toc-cost-0" class="nav-link" data-scroll-target="#cost-0"><span class="header-section-number">1.1.4</span> Cost ($0)</a></li>
  <li><a href="#operating-systems-and-guis" id="toc-operating-systems-and-guis" class="nav-link" data-scroll-target="#operating-systems-and-guis"><span class="header-section-number">1.1.5</span> Operating Systems and GUIs</a></li>
  <li><a href="#reproducible-research" id="toc-reproducible-research" class="nav-link" data-scroll-target="#reproducible-research"><span class="header-section-number">1.1.6</span> Reproducible Research</a></li>
  </ul></li>
  <li><a href="#why-isnt-everyone-a-user" id="toc-why-isnt-everyone-a-user" class="nav-link" data-scroll-target="#why-isnt-everyone-a-user"><span class="header-section-number">1.2</span> Why Isn’t Everyone a Use<strong><span class="sans-serif">R</span></strong>?</a>
  <ul class="collapse">
  <li><a href="#one-and-only" id="toc-one-and-only" class="nav-link" data-scroll-target="#one-and-only"><span class="header-section-number">1.2.1</span> One and Only</a></li>
  <li><a href="#steep-learning-curve" id="toc-steep-learning-curve" class="nav-link" data-scroll-target="#steep-learning-curve"><span class="header-section-number">1.2.2</span> Steep Learning Curve</a></li>
  </ul></li>
  <li><a href="#suggestions-for-learning-r" id="toc-suggestions-for-learning-r" class="nav-link" data-scroll-target="#suggestions-for-learning-r"><span class="header-section-number">1.3</span> Suggestions for Learning <strong><span class="sans-serif">R</span></strong></a></li>
  <li><a href="#how-to-obtain-r" id="toc-how-to-obtain-r" class="nav-link" data-scroll-target="#how-to-obtain-r"><span class="header-section-number">1.4</span> How To Obtain <strong><span class="sans-serif">R</span></strong></a>
  <ul class="collapse">
  <li><a href="#how-to-obtain-rstudio" id="toc-how-to-obtain-rstudio" class="nav-link" data-scroll-target="#how-to-obtain-rstudio"><span class="header-section-number">1.4.1</span> How to Obtain RStudio</a></li>
  <li><a href="#contributed-packages" id="toc-contributed-packages" class="nav-link" data-scroll-target="#contributed-packages"><span class="header-section-number">1.4.2</span> Contributed Packages</a></li>
  </ul></li>
  <li><a href="#getting-started-with-r" id="toc-getting-started-with-r" class="nav-link" data-scroll-target="#getting-started-with-r"><span class="header-section-number">2</span> Getting Started with <strong><span class="sans-serif">R</span></strong></a>
  <ul class="collapse">
  <li><a href="#using-r-as-a-calculator" id="toc-using-r-as-a-calculator" class="nav-link" data-scroll-target="#using-r-as-a-calculator"><span class="header-section-number">2.1</span> Using <strong><span class="sans-serif">R</span></strong> as a Calculator</a></li>
  <li><a href="#making-comparisons-logical-operators" id="toc-making-comparisons-logical-operators" class="nav-link" data-scroll-target="#making-comparisons-logical-operators"><span class="header-section-number">2.2</span> Making Comparisons: Logical Operators</a></li>
  <li><a href="#vectors-and-sequences" id="toc-vectors-and-sequences" class="nav-link" data-scroll-target="#vectors-and-sequences"><span class="header-section-number">2.3</span> Vectors and Sequences</a></li>
  <li><a href="#matrices-and-arrays" id="toc-matrices-and-arrays" class="nav-link" data-scroll-target="#matrices-and-arrays"><span class="header-section-number">2.4</span> Matrices and Arrays</a></li>
  </ul></li>
  <li><a href="#using-scripts" id="toc-using-scripts" class="nav-link" data-scroll-target="#using-scripts"><span class="header-section-number">3</span> Using Scripts</a>
  <ul class="collapse">
  <li><a href="#scripts-in-r-gui" id="toc-scripts-in-r-gui" class="nav-link" data-scroll-target="#scripts-in-r-gui"><span class="header-section-number">3.1</span> Scripts in <strong><span class="sans-serif">R</span></strong> GUI</a></li>
  <li><a href="#comments" id="toc-comments" class="nav-link" data-scroll-target="#comments"><span class="header-section-number">3.2</span> Comments</a></li>
  <li><a href="#rstudio" id="toc-rstudio" class="nav-link" data-scroll-target="#rstudio"><span class="header-section-number">3.3</span> <strong><span class="sans-serif">R</span></strong>Studio</a></li>
  <li><a href="#sample-script" id="toc-sample-script" class="nav-link" data-scroll-target="#sample-script"><span class="header-section-number">3.4</span> Sample Script</a></li>
  </ul></li>
  <li><a href="#objects" id="toc-objects" class="nav-link" data-scroll-target="#objects"><span class="header-section-number">4</span> Objects</a>
  <ul class="collapse">
  <li><a href="#assignment" id="toc-assignment" class="nav-link" data-scroll-target="#assignment"><span class="header-section-number">4.1</span> Assignment</a></li>
  <li><a href="#manipulating-objects" id="toc-manipulating-objects" class="nav-link" data-scroll-target="#manipulating-objects"><span class="header-section-number">4.2</span> Manipulating Objects</a></li>
  <li><a href="#indexing-objects" id="toc-indexing-objects" class="nav-link" data-scroll-target="#indexing-objects"><span class="header-section-number">4.3</span> Indexing Objects</a>
  <ul class="collapse">
  <li><a href="#indexing-vectors" id="toc-indexing-vectors" class="nav-link" data-scroll-target="#indexing-vectors"><span class="header-section-number">4.3.1</span> Indexing Vectors</a></li>
  <li><a href="#indexing-matrices" id="toc-indexing-matrices" class="nav-link" data-scroll-target="#indexing-matrices"><span class="header-section-number">4.3.2</span> Indexing Matrices</a></li>
  </ul></li>
  <li><a href="#index-assignment" id="toc-index-assignment" class="nav-link" data-scroll-target="#index-assignment"><span class="header-section-number">4.4</span> Index Assignment</a></li>
  <li><a href="#aside-missing-index" id="toc-aside-missing-index" class="nav-link" data-scroll-target="#aside-missing-index"><span class="header-section-number">4.5</span> Aside: Missing Index?</a></li>
  <li><a href="#object-classes" id="toc-object-classes" class="nav-link" data-scroll-target="#object-classes"><span class="header-section-number">4.6</span> Object Classes</a></li>
  <li><a href="#how-to-mix-variables-of-different-classes" id="toc-how-to-mix-variables-of-different-classes" class="nav-link" data-scroll-target="#how-to-mix-variables-of-different-classes"><span class="header-section-number">4.7</span> How to Mix Variables of Different Classes</a></li>
  </ul></li>
  <li><a href="#data-for-analysis" id="toc-data-for-analysis" class="nav-link" data-scroll-target="#data-for-analysis"><span class="header-section-number">5</span> Data for Analysis</a>
  <ul class="collapse">
  <li><a href="#creating-data-random-numbers" id="toc-creating-data-random-numbers" class="nav-link" data-scroll-target="#creating-data-random-numbers"><span class="header-section-number">5.1</span> Creating Data: Random numbers</a>
  <ul class="collapse">
  <li><a href="#functions-about-probability-distributions" id="toc-functions-about-probability-distributions" class="nav-link" data-scroll-target="#functions-about-probability-distributions"><span class="header-section-number">5.1.1</span> Functions about Probability Distributions</a></li>
  </ul></li>
  <li><a href="#reading-data-from-files" id="toc-reading-data-from-files" class="nav-link" data-scroll-target="#reading-data-from-files"><span class="header-section-number">5.2</span> Reading data from files</a></li>
  <li><a href="#importing-from-excel" id="toc-importing-from-excel" class="nav-link" data-scroll-target="#importing-from-excel"><span class="header-section-number">5.3</span> Importing from Excel</a>
  <ul class="collapse">
  <li><a href="#straight-from-excel" id="toc-straight-from-excel" class="nav-link" data-scroll-target="#straight-from-excel"><span class="header-section-number">5.3.1</span> Straight from Excel</a></li>
  </ul></li>
  <li><a href="#data-from-other-formats" id="toc-data-from-other-formats" class="nav-link" data-scroll-target="#data-from-other-formats"><span class="header-section-number">5.4</span> Data from other Formats</a></li>
  <li><a href="#exporting-data" id="toc-exporting-data" class="nav-link" data-scroll-target="#exporting-data"><span class="header-section-number">5.5</span> Exporting Data</a></li>
  <li><a href="#missing-values-in-data-files" id="toc-missing-values-in-data-files" class="nav-link" data-scroll-target="#missing-values-in-data-files"><span class="header-section-number">5.6</span> Missing Values in Data files</a>
  <ul class="collapse">
  <li><a href="#the-which-function" id="toc-the-which-function" class="nav-link" data-scroll-target="#the-which-function"><span class="header-section-number">5.6.1</span> The <code>which</code> function</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#student-t-tests" id="toc-student-t-tests" class="nav-link" data-scroll-target="#student-t-tests"><span class="header-section-number">6</span> Student t-tests</a>
  <ul class="collapse">
  <li><a href="#one-sample-t-test" id="toc-one-sample-t-test" class="nav-link" data-scroll-target="#one-sample-t-test"><span class="header-section-number">6.1</span> One-sample t-test</a></li>
  <li><a href="#independent-samples-t-tests" id="toc-independent-samples-t-tests" class="nav-link" data-scroll-target="#independent-samples-t-tests"><span class="header-section-number">6.2</span> Independent Samples t-tests</a>
  <ul class="collapse">
  <li><a href="#the-formula-operator-sim" id="toc-the-formula-operator-sim" class="nav-link" data-scroll-target="#the-formula-operator-sim"><span class="header-section-number">6.2.1</span> The formula operator (<span class="math inline">\(\sim\)</span>)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#chi-square-tests" id="toc-chi-square-tests" class="nav-link" data-scroll-target="#chi-square-tests"><span class="header-section-number">7</span> Chi-Square tests</a>
  <ul class="collapse">
  <li><a href="#goodness-of-fit" id="toc-goodness-of-fit" class="nav-link" data-scroll-target="#goodness-of-fit"><span class="header-section-number">7.1</span> Goodness of Fit</a></li>
  <li><a href="#chi-square-test-of-independence" id="toc-chi-square-test-of-independence" class="nav-link" data-scroll-target="#chi-square-test-of-independence"><span class="header-section-number">7.2</span> Chi-Square Test of Independence</a></li>
  <li><a href="#fishers-exact-test" id="toc-fishers-exact-test" class="nav-link" data-scroll-target="#fishers-exact-test"><span class="header-section-number">7.3</span> Fisher’s Exact Test</a></li>
  </ul></li>
  <li><a href="#linear-models" id="toc-linear-models" class="nav-link" data-scroll-target="#linear-models"><span class="header-section-number">8</span> Linear Models</a>
  <ul class="collapse">
  <li><a href="#another-example-of-data-entry" id="toc-another-example-of-data-entry" class="nav-link" data-scroll-target="#another-example-of-data-entry"><span class="header-section-number">8.0.1</span> Another example of data entry</a></li>
  <li><a href="#solution" id="toc-solution" class="nav-link" data-scroll-target="#solution"><span class="header-section-number">8.0.2</span> Solution</a></li>
  <li><a href="#simple-linear-regression-using-the-lm-function" id="toc-simple-linear-regression-using-the-lm-function" class="nav-link" data-scroll-target="#simple-linear-regression-using-the-lm-function"><span class="header-section-number">8.1</span> Simple Linear Regression using the <code>lm</code> function</a></li>
  <li><a href="#analysis-of-variance" id="toc-analysis-of-variance" class="nav-link" data-scroll-target="#analysis-of-variance"><span class="header-section-number">8.2</span> Analysis of Variance</a></li>
  <li><a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression"><span class="header-section-number">8.3</span> Multiple Linear Regression</a></li>
  </ul></li>
  <li><a href="#lists" id="toc-lists" class="nav-link" data-scroll-target="#lists"><span class="header-section-number">9</span> Lists</a>
  <ul class="collapse">
  <li><a href="#string-manipulation" id="toc-string-manipulation" class="nav-link" data-scroll-target="#string-manipulation"><span class="header-section-number">9.1</span> String Manipulation</a></li>
  <li><a href="#lists-1" id="toc-lists-1" class="nav-link" data-scroll-target="#lists-1"><span class="header-section-number">9.2</span> Lists</a></li>
  </ul></li>
  <li><a href="#generalized-linear-models-glm" id="toc-generalized-linear-models-glm" class="nav-link" data-scroll-target="#generalized-linear-models-glm"><span class="header-section-number">10</span> Generalized Linear Models (GLM)</a>
  <ul class="collapse">
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression"><span class="header-section-number">10.1</span> Logistic Regression</a></li>
  </ul></li>
  <li><a href="#creating-functions" id="toc-creating-functions" class="nav-link" data-scroll-target="#creating-functions"><span class="header-section-number">11</span> Creating Functions</a></li>
  <li><a href="#programming" id="toc-programming" class="nav-link" data-scroll-target="#programming"><span class="header-section-number">12</span> Programming</a>
  <ul class="collapse">
  <li><a href="#branching" id="toc-branching" class="nav-link" data-scroll-target="#branching"><span class="header-section-number">12.1</span> Branching</a></li>
  <li><a href="#looping" id="toc-looping" class="nav-link" data-scroll-target="#looping"><span class="header-section-number">12.2</span> Looping</a></li>
  <li><a href="#blood-pressure-example-revisited" id="toc-blood-pressure-example-revisited" class="nav-link" data-scroll-target="#blood-pressure-example-revisited"><span class="header-section-number">12.3</span> Blood Pressure Example Revisited</a></li>
  <li><a href="#the-apply-function" id="toc-the-apply-function" class="nav-link" data-scroll-target="#the-apply-function"><span class="header-section-number">12.4</span> The <code>apply</code> Function</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The <strong><span class="sans-serif">R</span></strong> <em>Environment</em></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong><span class="sans-serif">R</span></strong> has been described as “an environment for statistical modeling and graphics." The word <em>environment</em> instead of <em>package</em> is one of the main reasons <strong><span class="sans-serif">R</span></strong> is distinct from other statistical programs. A <em>package</em> gives a user a fixed set of tools. An <em>environment</em>, in addition to providing a fixed set of tools, allows users to customize those existing tools and to develop their own tools to suit their unique needs.</p>
<section id="why-are-there-so-many-users" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="why-are-there-so-many-users"><span class="header-section-number">1.1</span> Why Are There So Many Use<strong><span class="sans-serif">R</span></strong>s?</h2>
<p>These are some of the likely reasons you are here today.</p>
<section id="statistical-tools" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="statistical-tools"><span class="header-section-number">1.1.1</span> Statistical Tools</h3>
<p>The <strong><span class="sans-serif">R</span></strong> environment contains many powerful tools for statistical analysis including</p>
<ul>
<li><p>Linear and Generalized Linear Models</p></li>
<li><p>Survival Analysis</p></li>
<li><p>Random and Mixed Effects Models</p></li>
<li><p>Classification and Clustering</p></li>
<li><p>Sample Size and Power Calculations</p></li>
<li><p>Multivariable analysis (FA, PCA, SEM, …)</p></li>
</ul>
<p>In this workshop will see and use sample code for many of these analyses.</p>
</section>
<section id="graphics" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="graphics"><span class="header-section-number">1.1.2</span> Graphics</h3>
<p>Many researchers use <strong><span class="sans-serif">R</span></strong> specifically for its excellent graphing capabilities. Graphics in <strong><span class="sans-serif">R</span></strong> are easy to implement and modify. Once you are comfortable with <strong><span class="sans-serif">R</span></strong>, you will have several powerful graphics packages at your fingertips. “Base graphics” has been supplemented by “grid graphics” and the “grammar of graphics.”</p>
</section>
<section id="extensibility" class="level3" data-number="1.1.3">
<h3 data-number="1.1.3" class="anchored" data-anchor-id="extensibility"><span class="header-section-number">1.1.3</span> Extensibility</h3>
<p>Despite the extensive built-in statistical techniques, the most powerful feature of <strong><span class="sans-serif">R</span></strong> is the ability for users to extend <strong><span class="sans-serif">R</span></strong>’s base capabilities. <strong><span class="sans-serif">R</span></strong> is a full-fledged programming language that allows users to write their own functions. Users can contribute their own “packages” that build on <strong><span class="sans-serif">R</span></strong>’s base capabilities. Users have contributed over 13,700 packages to CRAN (Comprehensive <strong><span class="sans-serif">R</span></strong> Archive Network) as of March 2019.</p>
</section>
<section id="cost-0" class="level3" data-number="1.1.4">
<h3 data-number="1.1.4" class="anchored" data-anchor-id="cost-0"><span class="header-section-number">1.1.4</span> Cost ($0)</h3>
<p><strong><span class="sans-serif">R</span></strong> is open source: the source code behind the software is free for all to examine and extend. <strong><span class="sans-serif">R</span></strong> grows by leaps and bounds as people from all fields develop new functions for use within <strong><span class="sans-serif">R</span></strong>’s computing environment. This is part of what makes <strong><span class="sans-serif">R</span></strong> so useful. Many complex statistical routines that not yet available in other statistical software systems have been programmed in <strong><span class="sans-serif">R</span></strong>, and these routines are freely available for use by anyone.</p>
</section>
<section id="operating-systems-and-guis" class="level3" data-number="1.1.5">
<h3 data-number="1.1.5" class="anchored" data-anchor-id="operating-systems-and-guis"><span class="header-section-number">1.1.5</span> Operating Systems and GUIs</h3>
<p><strong><span class="sans-serif">R</span></strong> runs on Windows, MacOS, and a variety of Unix platforms. In Windows, there are at least four GUIs: the standard <strong><span class="sans-serif">R</span></strong> GUI, <strong><span class="sans-serif">R</span></strong>Studio, Tinn-<strong><span class="sans-serif">R</span></strong>, and <strong><span class="sans-serif">R</span></strong> Commander. We will be using the standard <strong><span class="sans-serif">R</span></strong> GUI some and <strong><span class="sans-serif">R</span></strong>Studio (<code>www.rstudio.com</code>) more. It organizes the user’s screen into panes that display programs/scripts, objects, graphics, and the <strong><span class="sans-serif">R</span></strong> console. <strong><span class="sans-serif">R</span></strong> Commander (<code>www.rcommander.com</code>), developed by John Fox at McMaster University, is a front-end for interacting with <strong><span class="sans-serif">R</span></strong> through menus. This package can be useful to <strong><span class="sans-serif">R</span></strong> beginners. It provides helpful tools for getting started and then displays the underlying <strong><span class="sans-serif">R</span></strong> code for each analysis to help the user learn the programming language. Tinn-<strong><span class="sans-serif">R</span></strong> (<code>sourceforge.net/projects/tinn-r/</code>) is another enhanced editor from Jose Claudio Faria.</p>
</section>
<section id="reproducible-research" class="level3" data-number="1.1.6">
<h3 data-number="1.1.6" class="anchored" data-anchor-id="reproducible-research"><span class="header-section-number">1.1.6</span> Reproducible Research</h3>
<p><strong><span class="sans-serif">R</span></strong> has several methods for integrating code, output, and interpretation into a single document. This allows consumers to confirm the original analysis and to investigate other approaches.</p>
</section>
</section>
<section id="why-isnt-everyone-a-user" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="why-isnt-everyone-a-user"><span class="header-section-number">1.2</span> Why Isn’t Everyone a Use<strong><span class="sans-serif">R</span></strong>?</h2>
<section id="one-and-only" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="one-and-only"><span class="header-section-number">1.2.1</span> One and Only</h3>
<p>Many users of statistics learn only one package: the one taught in their first introductory statistics course. Historically this has rarely been <strong><span class="sans-serif">R</span></strong>, but there are signs this is changing.</p>
</section>
<section id="steep-learning-curve" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="steep-learning-curve"><span class="header-section-number">1.2.2</span> Steep Learning Curve</h3>
<p>It can take time to get comfortable and productive with <strong><span class="sans-serif">R</span></strong>. A user often interacts with <strong><span class="sans-serif">R</span></strong> through typed commands, rather than via a point-and-click menu system. For users with minimal background writing code, it can take some time to get the hang of using <strong><span class="sans-serif">R</span></strong>. Furthermore, while the help system is comprehensive for the base packages, it’s quality ranges for community-written packages. Don’t get frustrated! You don’t have to be an expert programmer to learn <strong><span class="sans-serif">R</span></strong>. The benefits (flexibility, extensibility, speed) are worth spending some time up front.</p>
</section>
</section>
<section id="suggestions-for-learning-r" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="suggestions-for-learning-r"><span class="header-section-number">1.3</span> Suggestions for Learning <strong><span class="sans-serif">R</span></strong></h2>
<ul>
<li><p>Learn interactively! Reading can help only so much. Most people learn <strong><span class="sans-serif">R</span></strong> best by typing commands themselves.</p></li>
<li><p>Ask questions of current <strong><span class="sans-serif">R</span></strong> users, e.g., your instructor.</p></li>
<li><p>Look at (and retype) lots of sample code. Experiment with modifications of the code. You won’t break <strong><span class="sans-serif">R</span></strong>. You’ll see many examples in this workshop but there is much more online.</p></li>
<li><p>Don’t worry about getting errors. Experienced <strong><span class="sans-serif">R</span></strong> users make errors all the time. Base <strong><span class="sans-serif">R</span></strong> has excellent error messages that are good learning opportunities themselves.</p>
<ul>
<li><p><code>www.r-project.org</code>: The <strong><span class="sans-serif">R</span></strong> Home page, the central webpage for the <strong><span class="sans-serif">R</span></strong> project. Here you will find links for downloading <strong><span class="sans-serif">R</span></strong>, downloading additional packages for <strong><span class="sans-serif">R</span></strong>, and almost everything else that you would like to know about the software or the people behind it.</p></li>
<li><p><code>cran.r-project.org/web/views/</code>: Task views summarize the most important packages involved in a subject field or analysis type.</p></li>
<li><p><code>journal.r-project.org</code>: The <strong><span class="sans-serif">R</span></strong> Journal</p></li>
<li><p><code>stats.stackexchange.com</code>: Cross-Validated</p></li>
<li><p><code>www.r-bloggers.com</code></p></li>
<li><p><code>stats.idre.ucla.edu/r/</code>: Institute for Digital Research and Education at UCLA</p></li>
<li><p><code>socialsciences.mcmaster.ca/jfox/</code>: John Fox’s home page</p></li>
<li><p><code>sas-and-r.blogspot.com/</code>: Examples of code to perform same task in each language</p></li>
</ul></li>
</ul>
</section>
<section id="how-to-obtain-r" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="how-to-obtain-r"><span class="header-section-number">1.4</span> How To Obtain <strong><span class="sans-serif">R</span></strong></h2>
<p><strong><span class="sans-serif">R</span></strong> is already installed on the lab workstations. The following information is useful if you need to install <strong><span class="sans-serif">R</span></strong> on another machine.</p>
<p>At the <strong><span class="sans-serif">R</span></strong> Project Web Page (<code>www.r-project.org</code>) the most important link is at the left hand side of the screen, under the “Download” heading. Click on the CRAN link (Comprehensive <strong><span class="sans-serif">R</span></strong> Archive Network), and, after you choose one of the U.S.&nbsp;mirrors, you will be taken to the page that you will use to download everything <strong><span class="sans-serif">R</span></strong>-related.</p>
<p>Once you find the CRAN web page, take the following steps to obtain <strong><span class="sans-serif">R</span></strong>:</p>
<ol type="1">
<li><p>Click on “Download <strong><span class="sans-serif">R</span></strong> for XXX” that best describes your operating system (Linux, OS X, Windows).</p></li>
<li><p>When using Windows, click on the “base” subdirectory. This will allow you to download the base <strong><span class="sans-serif">R</span></strong> packages.</p></li>
<li><p>Click the “Download <strong><span class="sans-serif">R</span></strong> 3.X.X for Windows” link. <strong><span class="sans-serif">R</span></strong> is updated quite frequently. At the time of this printing, version 3.5.2 is available. Save the .exe file somewhere on your computer.</p></li>
<li><p>Double-click on the .exe file once it has been downloaded. A wizard will appear that will guide you through the setup of the <strong><span class="sans-serif">R</span></strong> software on your machine.</p></li>
<li><p>Once you are finished, you should have an <strong><span class="sans-serif">R</span></strong> icon on your desktop that gives you a shortcut to the <strong><span class="sans-serif">R</span></strong> system. Double-click on this icon, and you are ready to go!</p></li>
</ol>
<section id="how-to-obtain-rstudio" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="how-to-obtain-rstudio"><span class="header-section-number">1.4.1</span> How to Obtain RStudio</h3>
<p><strong><span class="sans-serif">R</span></strong>Studio is already installed on the lab workstations. The following information is useful if you need to install <strong><span class="sans-serif">R</span></strong>Studio on another machine.</p>
<p>Visit (<code>www.rstudio.com</code>) and download the free desktop version of <strong><span class="sans-serif">R</span></strong>Studio.</p>
</section>
<section id="contributed-packages" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="contributed-packages"><span class="header-section-number">1.4.2</span> Contributed Packages</h3>
<p>What exactly are “additional contributed packages”? <strong><span class="sans-serif">R</span></strong> is an open source software environment, so users are free to explore the code behind the software and to write their own new code. Statisticians, researchers, and other users have written additional packages for <strong><span class="sans-serif">R</span></strong> that perform complex analyses (and simple ones!). In order to use these packages and the functions within them, you first need to download them. Base <strong><span class="sans-serif">R</span></strong> comprises many packages, but odds are that you will discover an uncommon analysis technique in your research that requires you to install an additional package that is not included by default.</p>
<p>These additional packages are usually found CRAN. However, there are other repositories as well (e.g., bioconductor, github).</p>
</section>
</section>
<section id="getting-started-with-r" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Getting Started with <strong><span class="sans-serif">R</span></strong></h1>
<p>Launch <strong><span class="sans-serif">R</span></strong> from the Start Menu or the desktop icon. (We’ll shift to <strong><span class="sans-serif">R</span></strong>Studio after we have some familiarity with using <strong><span class="sans-serif">R</span></strong> interactively.)</p>
<section id="using-r-as-a-calculator" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="using-r-as-a-calculator"><span class="header-section-number">2.1</span> Using <strong><span class="sans-serif">R</span></strong> as a Calculator</h2>
<p><strong><span class="sans-serif">R</span></strong> can perform basic arithmetic operations. Type the following expressions at the command prompt in the <strong><span class="sans-serif">R</span></strong> console window.</p>
<p><code>&gt; 5+3</code></p>
<p><code>&gt; 5-3</code></p>
<p><code>&gt; 5/3</code></p>
<p><code>&gt; 5*3</code></p>
<p><code>&gt; 5^3</code></p>
<p><code>&gt; 4 + 2 * 3</code></p>
<p><code>&gt; (4 + 2) * 3</code></p>
<p>If you have missing input (represented in <strong><span class="sans-serif">R</span></strong> by NA), the output will likely be missing:</p>
<p><code>&gt; (4 + NA) * 3</code></p>
<p>If you try something mathematically shoddy, you will likely be told:</p>
<p><code>&gt; 0 / 0</code></p>
<p><code>&gt; 1 / 0</code></p>
<p><code>&gt; -1 / 0</code></p>
<p><strong><span class="sans-serif">R</span></strong> has many built-in mathematical functions.</p>
<p><code>&gt; log(100)</code></p>
<p><code>&gt; sqrt(9)</code></p>
<p><code>&gt; sqrt(-9)</code></p>
<p><code>&gt; sqrt(-9 + 0i)</code></p>
<p>This is your first indication that an <strong><span class="sans-serif">R</span></strong> function may behave differently depending on the <em>type</em> of input.</p>
<p><code>&gt; sqrt(NA)</code></p>
<p><code>&gt; exp(1)</code></p>
<p>An <em>argument</em> is a parameter that is passed to a function. The <code>sqrt</code> and <code>exp</code> functions only take a single argument. Many functions, including <code>log</code>, take more than one argument. Arguments are separated by commas.</p>
<p><code>&gt; round(5.123, 2)</code></p>
<p>If not all arguments are provided, <strong><span class="sans-serif">R</span></strong> may use a default value.</p>
<p><code>&gt; round(5.123)</code></p>
<p>Some other basic functions:</p>
<p><code>&gt; ceiling(5.123)</code></p>
<p><code>&gt; floor(5.123)</code></p>
<p>The “Remainder” and Integer Division operations:</p>
<p><code>&gt; 17 %% 5</code></p>
<p><code>&gt; 17 %/% 5</code></p>
<p><strong>Review of logarithms</strong> If <span class="math inline">\(a^y = x\)</span>, then <span class="math inline">\(\log_a(x) = y\)</span>. For example, <span class="math inline">\(10^2 = 100\)</span> and <span class="math inline">\(\log_{10}(100) = 2\)</span>. Three common choices of the base are <span class="math inline">\(10\)</span>, <span class="math inline">\(2\)</span>, and <span class="math inline">\(e\)</span>. What is the default choice in <strong><span class="sans-serif">R</span></strong>?</p>
<p><code>&gt; log(10)</code></p>
<p><code>&gt; log(2)</code></p>
<p><code>&gt; log(exp(1))</code></p>
<p>Suppose you are working with a dataset and you wish to apply the <span class="math inline">\(\log_{10}\)</span> transformation. How can we instruct <strong><span class="sans-serif">R</span></strong> to take logarithms base 10? <strong><span class="sans-serif">R</span></strong>’s help pages are good sources of information for questions such as these. Two ways to view a function’s help page are ‘?’ and ‘help’. A more generic approach might be searching “take log in r” with your favorite search engine.</p>
<p><code>&gt; ?log</code></p>
<p><code>&gt; help(log)</code></p>
<p>The <code>log</code> function can take two arguments including the <em>base</em> argument. Arguments can be specified in several ways.</p>
<p>The argument name can be stated explicitly:</p>
<p><code>&gt; log(x=25, base=5)</code></p>
<p>The argument name can be abbreviated as long as the abbreviation is unique:</p>
<p><code>&gt; log(x=25, b=5)</code></p>
<p>Not all arguments need to be named:</p>
<p><code>&gt; log(25, b=5)</code></p>
<p><code>&gt; log(b=5, 25)</code></p>
<p>We don’t have to use the argument names at all, in which case the arguments are matched by the order listed. Compare</p>
<p><code>&gt; log(25, 5)</code></p>
<p><code>&gt; log(5, 25)</code></p>
<p><strong><span class="sans-serif">R</span></strong> may return an error if you incorrectly name a function argument.</p>
<p><code>&gt; log(25, be=5)</code></p>
</section>
<section id="making-comparisons-logical-operators" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="making-comparisons-logical-operators"><span class="header-section-number">2.2</span> Making Comparisons: Logical Operators</h2>
<p><strong><span class="sans-serif">R</span></strong> has logical operators that will return “TRUE” or “FALSE” (or possibly “NA” if you have missing values).</p>
<p><code>&gt; 5 == 6</code></p>
<p><code>&gt; 5 != 6</code></p>
<p><code>&gt; 5 &lt; 6</code></p>
<p><code>&gt; 5 &gt; 6</code></p>
<p><code>&gt; 5 &lt;= 6</code></p>
<p><code>&gt; 5 &lt;= NA</code></p>
<p><code>&gt; 5 &lt;= Inf</code></p>
<p><code>&gt; !TRUE</code></p>
<p><code>&gt; (1 + 2) == 3</code></p>
<p><strong><span class="sans-serif">R</span></strong> has “and” and “or” operators (there are others):</p>
<p><code>&gt; (5 &lt; 6) &amp; (7 == 8)</code></p>
<p><code>&gt; (5 &lt; 6) | (7 == 8)</code></p>
<p><code>&gt; (5 &lt; 6) | NA</code></p>
<p><strong>Be careful of comparisons and floating point arithmetic</strong>:</p>
<p><code>&gt; (.1 + .2) == .3</code></p>
<p><code>&gt; 5 == sqrt(5)^2</code></p>
<p><code>&gt; 5 - sqrt(5)^2</code></p>
<p>The <code>all.equal</code> function will test if two values are “close enough”:</p>
<p><code>&gt; all.equal(5, sqrt(5)^2)</code></p>
<p><code>&gt; ?all.equal</code></p>
<p>This is not bug of <strong><span class="sans-serif">R</span></strong>. It is a feature of computers using binary representation of floating point numbers and storing them with finite precision. This is common enough to make the <strong><span class="sans-serif">R</span></strong> FAQ (7.31): <code>https://cran.r-project.org/doc/FAQ/R-FAQ.html</code>. To quote from “The Elements of Programming Style” by Kernighan and Plauger: “10.0 times 0.1 is hardly ever 1.0.”</p>
</section>
<section id="vectors-and-sequences" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="vectors-and-sequences"><span class="header-section-number">2.3</span> Vectors and Sequences</h2>
<p><strong><span class="sans-serif">R</span></strong> is a ‘vectorized’ language. Many functions operate on an entire vector of numbers as easily as on a single number. This feature allows the user to think in terms of manipulating entire data variables rather than one data element at a time. For example (once we have learned about storing objects), we can write <code>mean(Height)</code> or <code>hist(Height)</code> to analyze a variable, rather than working with the individual data values.</p>
<p>Thus it is important to be able to create and manipulate vectors. Numbers can be combined into a vector with the function ‘c’, which stands for <em>combine</em>.</p>
<p><code>&gt; c(3, 9, 2)</code></p>
<p>The following commands produce exactly the same output, namely a vector with the integers 1 to 10. In <strong><span class="sans-serif">R</span></strong>, there are often many ways of doing the same thing.</p>
<p><code>&gt; c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)</code></p>
<p><code>&gt; 1:10</code></p>
<p><code>&gt; seq(1, 10, 1)</code></p>
<p><code>&gt; seq_len(10)</code></p>
<p><code>&gt; ?seq</code></p>
<p>You can specify a sequence’s increment or length using the <em>by</em> and <em>length</em> arguments.</p>
<p><code>&gt; seq(0, 200, by=4)</code></p>
<p><code>&gt; seq(0, 200, length=13)</code></p>
<p><code>&gt; rep(3, 12)</code></p>
<p>In <strong><span class="sans-serif">R</span></strong>, functions can be nested. In the following examples, the inner function, <code>c</code>, is used to create a vector and the outer function uses that vector as an argument.</p>
<p><code>&gt; rep(c(3,9,2), times=4)</code></p>
<p><code>&gt; rep(c(3,9,2), each=4)</code></p>
<p><code>&gt; rep(c(3,9,2), length=12)</code></p>
<p><code>&gt; rep(c(3,9,2), times=c(2,9,1))</code></p>
</section>
<section id="matrices-and-arrays" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="matrices-and-arrays"><span class="header-section-number">2.4</span> Matrices and Arrays</h2>
<p>In <strong><span class="sans-serif">R</span></strong>, a matrix or an array is just a vector with a dimension <em>attribute</em>. The <code>matrix</code> command can rearrange a vector into a matrix.</p>
<p><code>&gt; matrix(1:12, nrow=3)</code></p>
<p>What happens if we don’t specify the number of rows using the argument <code>nrow</code>?</p>
<p><code>&gt; matrix(1:12)</code></p>
<p>The result is still a matrix, but the default is to put each element in a separate row. What happens if we specify an inappropriate number of rows?</p>
<p><code>&gt; matrix(1:12, nrow=5)</code></p>
<p>When the number of rows and the number of elements are not coherent, <strong><span class="sans-serif">R</span></strong> issues a warning.</p>
<p>A vector has 1 dimension; a matrix has 2 dimensions; an array can have any number of dimensions. These have 3 dimensions:</p>
<p><code>&gt; array(1:12, dim=c(2,2,3))</code></p>
<p><code>&gt; array(1:12, dim=c(2,3,2))</code></p>
</section>
</section>
<section id="using-scripts" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Using Scripts</h1>
<p>Until now, we have submitted each command to <strong><span class="sans-serif">R</span></strong> by typing directly at the command prompt. In almost all situations, it is <strong>much</strong> better to type code in a separate file called a script file. There are many advantages of using script files.</p>
<ul>
<li><p>Repeatability</p></li>
<li><p>Editing</p></li>
<li><p>Submitting many commands at once</p></li>
</ul>
<section id="scripts-in-r-gui" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="scripts-in-r-gui"><span class="header-section-number">3.1</span> Scripts in <strong><span class="sans-serif">R</span></strong> GUI</h2>
<p>To open an <strong><span class="sans-serif">R</span></strong> script, go to File <code>-&gt;</code> New Script. You can type your commands in the resulting windows. It is useful to save your script files with a .R extension. Then the operating system recognizes this as an <strong><span class="sans-serif">R</span></strong> file.</p>
<p>After opening a new script, type</p>
<p><code>&gt; history()</code></p>
<p>A new window will open with the last 25 commands you have used. You can get a longer history with, say,</p>
<p><code>&gt; history(100)</code></p>
<p>Select all your commands and copy-paste them to the new script. Save the file with a .R extension.</p>
<p>There are several ways of submitting commands from the <strong><span class="sans-serif">R</span></strong> script window.</p>
<ul>
<li><p>Copy and Paste from the script window to the interpreter window</p></li>
<li><p>Control-r</p></li>
<li><p>The <code>source</code> command. If your file is saved as <em>myfile.R</em>, you can run all the commands in the file by typing the following line at the command prompt.</p>
<p><code>&gt; source("myfile.R")</code></p>
<p>In order for <strong><span class="sans-serif">R</span></strong> to read your script, you must use the full path or be in the correct working directory. To change the current working directory, go to File <code>-&gt;</code> Change Dir, then browse to the appropriate folder.</p>
<p>To see the files in the current working directory, type:</p>
<p><code>&gt; dir()</code></p>
<p>Another possibility is to find the file using</p>
<p><code>&gt; source(file.choose())</code></p>
<p>but this does not change the working directory.</p></li>
</ul>
</section>
<section id="comments" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="comments"><span class="header-section-number">3.2</span> Comments</h2>
<p>Documentation and formatting are essential to writing effective <strong><span class="sans-serif">R</span></strong> code. If you come back to a project after a few months (days? hours?), you want to know what the code is doing without retracing every single step. Comments in <strong><span class="sans-serif">R</span></strong> can be inserted with the <code>#</code> symbol. <strong><span class="sans-serif">R</span></strong> will not process the rest of the line after the <code>#</code>.</p>
<p><code>&gt; 5 &lt; 6</code></p>
<p><code>&gt; 5 # &lt; 6</code></p>
<p>The following is an example of a commented <strong><span class="sans-serif">R</span></strong> script. Some of the functions we have used before; others will be explained later. Let’s open it in <strong><span class="sans-serif">R</span></strong>Studio and see what it does.</p>
</section>
<section id="rstudio" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="rstudio"><span class="header-section-number">3.3</span> <strong><span class="sans-serif">R</span></strong>Studio</h2>
<p><strong><span class="sans-serif">R</span></strong>Studio is an interface to <strong><span class="sans-serif">R</span></strong>. It organizes the user’s screen into windows that display programs (scripts), objects, graphics, and the <strong><span class="sans-serif">R</span></strong> interpreter. Launch <strong><span class="sans-serif">R</span></strong>Studio from the start menu. Click on the folder in the upper left corner and browse to the folder containing the script “sample script.R”. The following should open in the upper left window.</p>
</section>
<section id="sample-script" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="sample-script"><span class="header-section-number">3.4</span> Sample Script</h2>
<p># sample script.R</p>
<p># Chris Andrews</p>
<p># Created 2015 04 01</p>
<p># Last Modified 2019 02 03</p>
<p># This script analyzes the Life Cycle Savings data.</p>
<p># See help(LifeCycleSavings) for more details.</p>
<p>#</p>
<p># Shorten the name and make local copy</p>
<p>Life = LifeCycleSavings</p>
<p># Examine Structure</p>
<p>head(Life)</p>
<p>dim(Life)</p>
<p>str(Life)</p>
<p># Descriptives</p>
<p>summary(Life)</p>
<p># Pairwise associations</p>
<p>cor(Life)</p>
<p>pairs(Life)</p>
<p># Fit a multiple regression model</p>
<p>mr.mod = lm(sr &nbsp; pop15 + pop75 + dpi + ddpi, data=Life)</p>
<p>summary(mr.mod)</p>
<p>anova(mr.mod)</p>
<p># Plot the fit</p>
<p>par(mfrow=c(2,2), las=1, mar=c(4.5,4.5,2,1))</p>
<p>plot(mr.mod)</p>
<p>Use “Ctrl-Enter” to submit each line of the script. Take note of what happens as each line is submitted to the interpreter.</p>
</section>
</section>
<section id="objects" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Objects</h1>
<section id="assignment" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="assignment"><span class="header-section-number">4.1</span> Assignment</h2>
<p>An <em>object</em> is an entity that contains information and can be manipulated by commands. <strong><span class="sans-serif">R</span></strong> has two main commands for assigning an object: ‘<span class="math inline">\(&lt;\)</span>-’ and ‘=’.</p>
<p><code>&gt; x &lt;- 5</code></p>
<p><code>&gt; x = 5</code></p>
<p>We will use ‘=’ throughout this document. However, many <strong><span class="sans-serif">R</span></strong> users prefer ‘<code>&lt;-</code>’, because ‘=’ is used for other things, too. A third method is very rarely used:</p>
<p><code>&gt; 5 -&gt; x</code></p>
<p>Each of the previous commands assigns the number <code>5</code> to the object <code>x</code>. Notice that <strong><span class="sans-serif">R</span></strong> produces no output when the above commands are run. In order to see what <strong><span class="sans-serif">R</span></strong> has done, type:</p>
<p><code>&gt; ls()</code></p>
<p>and/or look at the environment window in the upper right corner. Now type</p>
<p><code>&gt; x</code></p>
<p>When you submit a command to <strong><span class="sans-serif">R</span></strong>, one of three things can happen.</p>
<ol type="1">
<li><p>You see a result: e.g.,</p>
<p><code>&gt; x</code></p>
<p><strong><span class="sans-serif">R</span></strong> prints the value of the expression.</p></li>
<li><p>You see nothing except another command prompt: e.g.,</p>
<p><code>&gt; y = log(x)</code></p>
<p>For an assignment, <strong><span class="sans-serif">R</span></strong> stores the value of <code>log(x)</code> in the object <code>y</code>, but produces no output.</p></li>
<li><p>You see an error message: e.g.,</p>
<p><code>&gt; y = lg(x)</code></p>
<p>Look at error messages – they can be informative!</p></li>
</ol>
</section>
<section id="manipulating-objects" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="manipulating-objects"><span class="header-section-number">4.2</span> Manipulating Objects</h2>
<p>We can perform mathematical operations on objects such as <code>x</code>.</p>
<p><code>&gt; x + 2</code></p>
<p>Notice that x has not changed:</p>
<p><code>&gt; x</code></p>
<p>We can change the value of x:</p>
<p><code>&gt; x = x + 2</code></p>
<p><code>&gt; x</code></p>
<p><em>Cautionary Tip</em>: It is very important to use caution when writing over a variable as above. If you need to use <code>x</code> later on, be sure you are using the correct value!</p>
<p>Start from scratch and perform operations on two objects.</p>
<p><code>&gt; x = 5</code></p>
<p><code>&gt; y = 2</code></p>
<p><code>&gt; x - y</code></p>
<p>If two objects are assigned to have the same value, they can be changed to differ. (Assigned by value not by assigned by reference, for those of you who know what that means.)</p>
<p><code>&gt; a = 3</code></p>
<p><code>&gt; b = a &nbsp;# Note: Assignment</code></p>
<p><code>&gt; b == a # Note: Test of Equality</code></p>
<p><code>&gt; a = a + 1</code></p>
<p><code>&gt; a</code></p>
<p>The value of <code>b</code> didn’t change.</p>
<p><code>&gt; b</code></p>
<p>Assign a vector of numbers to the object <code>x</code></p>
<p><code>&gt; x = c(3, 5, 9, 10)</code></p>
<p><code>&gt; x</code></p>
<p>Get a list of the objects in the workspace.</p>
<p><code>&gt; ls()</code></p>
<p>Remove an object.</p>
<p><code>&gt; rm(x)</code></p>
</section>
<section id="indexing-objects" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="indexing-objects"><span class="header-section-number">4.3</span> Indexing Objects</h2>
<p>Situations frequently arise when you want to access select portions of a database. In this section, we discuss how to extract elements of vectors and matrices.</p>
<section id="indexing-vectors" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="indexing-vectors"><span class="header-section-number">4.3.1</span> Indexing Vectors</h3>
<p><code>&gt; x = c(13,21,99,10,0,-6)</code></p>
<p>Suppose that we only need the first element of the vector <code>x</code>. To extract the first element, we type the name of the entire vector, followed by the index we want to extract enclosed in brackets.</p>
<p><code>&gt; x[1]</code></p>
<p>We can save the extracted part to a new object</p>
<p><code>&gt; z = x[1]</code></p>
<p><code>&gt; z</code></p>
<p>We often will want to extract more than one element of a vector. Each of the following two lines of code extracts the first three elements of the vector <code>x</code>.</p>
<p><code>&gt; x[c(1,2,3)]</code></p>
<p><code>&gt; x[1:3]</code></p>
<p>What happens if we try to extract the first three elements in the following way?</p>
<p><code>&gt; x[1,2,3]</code></p>
<p>Elements can be extracted in any order and elements can be extracted any number of times. All of the following are legitimate methods of extracting multiple elements from a vector.</p>
<p><code>&gt; x[c(2,4,5)]</code></p>
<p><code>&gt; x[c(4,5,1)]</code></p>
<p><code>&gt; x[c(5,1,5,2,1,1,1,5)]</code></p>
<p>The following code extracts all elements of x <em>except</em> the second.</p>
<p><code>&gt; x[-2]</code></p>
<p>What will this do?</p>
<p><code>&gt; x[-c(2,4)]</code></p>
</section>
<section id="indexing-matrices" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="indexing-matrices"><span class="header-section-number">4.3.2</span> Indexing Matrices</h3>
<p>To extract an element from a matrix, you may specify two values: the row value and the column value. The row and column are separated by a column.</p>
<p><code>&gt; M1 = matrix(1:12, nrow=3, byrow=TRUE)</code> # (this is obj5 from before, so M1 = obj5 works too)</p>
<p><code>&gt; M1</code></p>
<p>Pick out the number from the second row and third column.</p>
<p><code>&gt; M1[2,3]</code></p>
<p>You can simultaneously select multiple rows and multiple columns.</p>
<p><code>&gt; M1[2,c(1,3)]</code></p>
<p><code>&gt; M1[c(2,3),c(1,2)]</code></p>
<p>If nothing is specified in the row position (before the comma), then every row is kept. Similarly, every column is kept if nothing is specified in the column position.</p>
<p><code>&gt; M1[,c(2,3)]</code></p>
<p><code>&gt; M1[c(1,2),]</code></p>
<p>If nothing is specified in either position, the entire matrix is returned.</p>
</section>
</section>
<section id="index-assignment" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="index-assignment"><span class="header-section-number">4.4</span> Index Assignment</h2>
<p>In addition to extracting certain indices, it is also possible to <em>assign</em> new values to certain elements of a vector or matrix.</p>
<p>The following two lines of code change an element of the vector <code>x</code> and the matrix <code>M1</code>.</p>
<p><code>&gt; x[3] = 5</code></p>
<p><code>&gt; M1[2,3] = 6</code></p>
</section>
<section id="aside-missing-index" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="aside-missing-index"><span class="header-section-number">4.5</span> Aside: Missing Index?</h2>
<p>If an index is missing, it might be any index. This is rarely what you want: Avoid missing values in your index.</p>
<p><code>&gt; x[NA]</code></p>
</section>
<section id="object-classes" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="object-classes"><span class="header-section-number">4.6</span> Object Classes</h2>
<p>So far we seem to have been working exclusively with numeric objects. <strong><span class="sans-serif">R</span></strong> can store objects of many different types. Suppose you are working with a data set that includes both quantitative and categorical variables. <strong><span class="sans-serif">R</span></strong> can store these as different classes. Let’s begin by looking at two basic classes, <code>numeric</code> and <code>character</code>.</p>
<p><code>&gt; x = 12</code></p>
<p><code>&gt; class(x)</code></p>
<p><code>&gt; y = c(3,5,2)</code></p>
<p><code>&gt; class(y)</code></p>
<p><strong><span class="sans-serif">R</span></strong> stores both the number <code>12</code> and the vector <code>c(3,5,2)</code> as an object of the class <em>numeric</em>. Strings are stored as <em>characters</em>.</p>
<p><code>&gt; x = "Hi"</code></p>
<p><code>&gt; class(x)</code></p>
<p><code>&gt; y = c("sample", "string")</code></p>
<p><code>&gt; class(y)</code></p>
<p>Elements of vectors and matrices must be of the same class.</p>
<p><code>&gt; mix = c("aa", -2)</code></p>
<p><code>&gt; mix</code></p>
<p><code>&gt; class(mix)</code></p>
<p><code>&gt; mix[2]</code></p>
<p><code>&gt; class(mix[2])</code></p>
<p>When working with data, this will create problems if a column representing a quantitative variable contains character text. The numeric is <em>promoted</em> to character.</p>
</section>
<section id="how-to-mix-variables-of-different-classes" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="how-to-mix-variables-of-different-classes"><span class="header-section-number">4.7</span> How to Mix Variables of Different Classes</h2>
<p>Matrices are not well-suited for storing data sets. Data sets frequently contain different types of variables (quantitative, qualitative). Matrices force all elements to be of the same class. A <code>data.frame</code> is particularly adept at handling data of different classes.</p>
<p><code>&gt; num = c(2,9,6,5)</code></p>
<p><code>&gt; char = LETTERS[c(24,24:26)]</code></p>
<p><code>&gt; dat = data.frame(num, char, stringsAsFactors=FALSE)</code></p>
<p><code>&gt; dat</code></p>
<p><code>&gt; class(dat)</code></p>
<p>Though data analysts will rarely spend their time investigating a data set as small this one, exploring data sets such as these can be helpful in learning <strong><span class="sans-serif">R</span></strong>’s capabilities. In the following code, we investigate the names and dimensions of the data set <code>dat</code>; we also investigate the properties of the columns of <code>dat</code>.</p>
<p><code>&gt; names(dat)</code></p>
<p><code>&gt; dim(dat)</code></p>
<p><code>&gt; nrow(dat)</code></p>
<p><code>&gt; ncol(dat)</code></p>
<p><code>&gt; class(dat[,1])</code></p>
<p><code>&gt; class(dat[,2])</code></p>
<p><strong><span class="sans-serif">R</span></strong> stores the first column as <em>numeric</em> and the second column as a <em>character</em>. <code>summary</code> gives a numerical summary of numeric variables and little useful information for character variables.</p>
<p><code>&gt; summary(dat)</code></p>
<p>It is likely that you want to store a categorical variable as a <em>factor</em> rather than a character vector. The default behavior of data.frame to do the conversion.</p>
<p><code>&gt; dat = data.frame(num, fac=char)</code></p>
<p>Now <strong><span class="sans-serif">R</span></strong> stores the first column as <em>numeric</em> and the second column as a <em>factor</em>. <code>summary</code> gives a numerical summary of numeric variables and a table for categorical variables.</p>
<p><code>&gt; class(dat[,2])</code></p>
<p><code>&gt; summary(dat)</code></p>
<p>Keeping track of column numbers can be tedious. It is often more convenient and cleaner to index by the column name. Name indexing uses the dollar sign (<code>$</code>) or double square braces (<code>[[]]</code>).</p>
<p><code>&gt; dat$num # Or dat[["num"]]</code></p>
<p><code>&gt; dat$fac # Or dat[["fac"]]</code></p>
<p>Factors can be created explicitly (not just as a side effect of the <code>data.frame</code> function)</p>
<p><code>&gt; fac = factor(char)</code></p>
<p>The <code>levels</code> function returns the levels of a factor.</p>
<p><code>&gt; levels(fac)</code></p>
</section>
</section>
<section id="data-for-analysis" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Data for Analysis</h1>
<section id="creating-data-random-numbers" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="creating-data-random-numbers"><span class="header-section-number">5.1</span> Creating Data: Random numbers</h2>
<p><strong><span class="sans-serif">R</span></strong> has excellent number generating capabilities. This makes <strong><span class="sans-serif">R</span></strong> a good programming environment for simulation studies. The <code>rnorm</code> function randomly draws from a univariate normal distribution. (The ‘r’ stands for random.)</p>
<p><code>&gt; rnorm(3)</code></p>
<p><code>&gt; rnorm(3, mean=10, sd=0.5)</code></p>
<p><code>&gt; x = rnorm(100, mean=10, sd=2)</code></p>
<p><code>&gt; hist(x, col="blue", main="100 Random Numbers from a Normal Distribution")</code></p>
<p>See <code>help(rnorm)</code> for more details. You can generate from many distributions using functions such as <code>rnorm</code>, <code>rt</code>, <code>rf</code>, <code>rbinom</code>, <code>runif</code>, <code>rexp</code>, and <code>rgamma</code>.</p>
<section id="functions-about-probability-distributions" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="functions-about-probability-distributions"><span class="header-section-number">5.1.1</span> Functions about Probability Distributions</h3>
<p><strong><span class="sans-serif">R</span></strong> is also a source of exact probability tables and therefore eliminates the need to flip to the back of a statistics textbook to calculate probabilities under curves or critical values. For example, you can calculate the 95% critical value of a t distribution with 34 degrees of freedom with the following command:</p>
<p><code>&gt; qt(0.975, df=34)</code></p>
<p>We can find the critical value of a standard normal distribution using <code>qnorm</code>. (The ‘q’ stands for quantile function.)</p>
<p><code>&gt; qnorm(0.975)</code></p>
<p>We can also find cumulative probabilities needed for p-values. (The ‘p’ stands for probability function.)</p>
<p><code>&gt; pnorm(-1.96)</code></p>
</section>
</section>
<section id="reading-data-from-files" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="reading-data-from-files"><span class="header-section-number">5.2</span> Reading data from files</h2>
<p>Researchers often analyze data that are stored in spread-sheet or text formats. The most common function to import data is <code>read.table</code>. Before looking at an example of how <code>read.table</code> is used, let’s consider common issues that arise when reading data into any program.</p>
<ul>
<li><p>What is the file name?</p></li>
<li><p>What is the file type?</p></li>
<li><p>Where is the file located?</p></li>
<li><p>Does the file include variable names?</p></li>
<li><p>How are fields separated (e.g., tab, comma, white-space)?</p></li>
<li><p>How are missing values stored?</p></li>
</ul>
<p>The <code>read.table</code> function is used in <strong><span class="sans-serif">R</span></strong> for importing text data into data set objects. This function requires that you have a valid data table in a text format (where rows are observations, and columns are variables) with every cell containing a data point. If there are any blanks, the function may not work properly. Missing values by default should be coded as NA before attempting to import text data. Columns should be separated by white space.</p>
<p>The <code>read.table</code> function has arguments that allow the user to control data importation features.</p>
<p><code>&gt; help(read.table)</code></p>
<p>The four most important arguments to the <code>read.table</code> function are <em>file</em>, <em>header</em>, <em>sep</em>, and <em>na.strings</em>. Let’s practice by importing the <em>samp2.dat</em> text file. Be sure to first change the working directory to the folder that contains <em>samp2.dat</em>. In <strong><span class="sans-serif">R</span></strong>Studio you can either use the Session &gt; Set Working Directory menu option or use the <code>setwd()</code> function.</p>
<p><code>&gt; gro = read.table("groceries.txt")</code></p>
<p><code>&gt; head(gro)</code></p>
<p><code>&gt; str(gro)</code></p>
<p>By passing only the <em>file</em> argument to <code>read.table</code>, we have left all other arguments at their default values. Notice that <strong><span class="sans-serif">R</span></strong> reads the variable names to be the first row of data rather than the column names. <strong><span class="sans-serif">R</span></strong> has stored the columns of <em>gro</em> as a factor.</p>
<p><code>&gt; gro = read.table("groceries.txt", header=TRUE)</code></p>
<p><code>&gt; head(gro)</code></p>
<p><code>&gt; str(gro)</code></p>
<p><code>&gt; tail(gro)</code></p>
<p><code>&gt; summary(gro)</code></p>
<p><code>&gt; dim(gro)</code></p>
</section>
<section id="importing-from-excel" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="importing-from-excel"><span class="header-section-number">5.3</span> Importing from Excel</h2>
<p>“How do I import my data into <strong><span class="sans-serif">R</span></strong> from Excel?” is a common question.</p>
<p>My answer is often: “Don’t!”</p>
<p>Excel spreadsheets contain attributes and formatting that often cause difficulty when transferring files between applications. In particular, dates, or text that looks like dates, are troublesome. Zip codes and MRNs lose their leading zeros. The easiest thing to do is to first export the data into either a tab-delimited (.dat, .tsv) or comma separated values (.csv) file. After the file is in a more portable format, then use <code>read.table</code> or <code>read.csv</code> into <strong><span class="sans-serif">R</span></strong>.</p>
<p>We use the <em>samp2.csv</em> file for practice.</p>
<p><code>&gt; dat2 = read.csv("samp2.csv", na.strings=c(NA, 88, 999))</code></p>
<p><code>&gt; dat2</code></p>
<p><code>read.csv</code> simply invokes <code>read.table</code> with a different set of default arguments. Notice that the default for <code>read.csv</code> is to include a header.</p>
<p><code>&gt; help(read.csv)</code></p>
<section id="straight-from-excel" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="straight-from-excel"><span class="header-section-number">5.3.1</span> Straight from Excel</h3>
<p>However it is possible to skip the .csv step using one of several <strong><span class="sans-serif">R</span></strong> packages. Option 1: Use the Import Dataset button above the environment window in <strong><span class="sans-serif">R</span></strong>Studio (obviously this only applies if using <strong><span class="sans-serif">R</span></strong>Studio). Option 2: Use the <code>read_excel</code> function in the <code>readxl</code> package (actually, Option 1 uses Option 2). Option 3: use package <code>xlsx</code>. Option 4: ...</p>
<p>These approaches may result in slightly different data formats. This is not a problem, just be certain to investigate your data after loading.</p>
</section>
</section>
<section id="data-from-other-formats" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="data-from-other-formats"><span class="header-section-number">5.4</span> Data from other Formats</h2>
<p><strong><span class="sans-serif">R</span></strong> can read directly from other formats with varying levels of success. Functions exist for fixed width formats, .sas7bdat, SAS xport, SPSS, Stata, DBF, ...</p>
</section>
<section id="exporting-data" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="exporting-data"><span class="header-section-number">5.5</span> Exporting Data</h2>
<p><strong><span class="sans-serif">R</span></strong> has facilities for exporting data. Suppose you make changes to a data set within <strong><span class="sans-serif">R</span></strong> and you want to save those changes permanently in a .csv or .xls file. The <code>write.csv</code> command exports an <strong><span class="sans-serif">R</span></strong> object to a text file. All you have to do is give <code>write.csv</code> two arguments: 1) the <strong><span class="sans-serif">R</span></strong> object to be exported, and 2) the name of the file.</p>
<p>For example, <code>write.csv(M, "newfile.csv")</code> will export the <strong><span class="sans-serif">R</span></strong> object <code>M</code> to a newly created file <code>newfile.csv</code>. We will modify <code>dat2</code> to include an <code>id</code> variable, and we write the updated data object to a csv file.</p>
<p><code>&gt; dat2$id = 1:nrow(dat2)</code></p>
<p><code>&gt; dat2</code></p>
<p><code>&gt; write.csv(dat2, "newfile.csv")</code></p>
<p><strong><span class="sans-serif">R</span></strong> can also write to text files using <code>write.table</code>.</p>
</section>
<section id="missing-values-in-data-files" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="missing-values-in-data-files"><span class="header-section-number">5.6</span> Missing Values in Data files</h2>
<p>Data files can represent missing data in many ways. Often Excel files have blank cells. Text files may use a special value such as 999 to represent missingness. SAS uses a period. Different codes may specify different reasons for the missingness such as non-response or an unreasonable value.</p>
<p>There are several ways to convert these conventions to NA in <strong><span class="sans-serif">R</span></strong> so they will (more likely) be treated properly in analyses. (There are entire statistics courses on “properly” dealing with missing data.)</p>
<p>Suppose that the <span class="math inline">\(88\)</span> and <span class="math inline">\(999\)</span> are codes indicating missing values. We want <strong><span class="sans-serif">R</span></strong> to interpret these values as missing rather than numeric. We can change these values to NA after reading in the data. First we identify them and then replace them by NA.</p>
<p><code>&gt; dat = read.csv("samp2.csv")</code></p>
<p><code>&gt; dat</code></p>
<p><code>&gt; dat$z == 88 | dat$z == 999</code></p>
<p><code>&gt; dat$z[dat$z == 88 | dat$z == 999]</code></p>
<p><code>&gt; dat$z[dat$z == 88 | dat$z == 999] = NA</code></p>
<p><code>&gt; dat</code></p>
<section id="the-which-function" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="the-which-function"><span class="header-section-number">5.6.1</span> The <code>which</code> function</h3>
<p>While we are on the subject of missing data (NA) and logical values (TRUE, FALSE), I want to mention the <code>which</code> function. It statement takes a logical statement (or a series of logical statements, some which may be missing) as an argument. It returns the indices for which the logical statement is TRUE.</p>
<p><code>&gt; a = c(6, 9, 10, 2, 999, NA)</code></p>
<p><code>&gt; is.na(a)</code></p>
<p><code>&gt; which(is.na(a))</code></p>
<p><code>&gt; which(!is.na(a))</code></p>
<p><code>&gt; a == 999</code></p>
<p><code>&gt; a[a == 999]</code></p>
<p><code>&gt; which(a == 999)</code></p>
<p><code>&gt; a[which(a == 999)]</code></p>
<p><code>&gt; a[which(a == 999)] = NA</code></p>
<p><code>&gt; a</code></p>
<p><code>&gt; is.na(a)</code></p>
<p>The <code>which</code> command is a very powerful tool for data management. Consider the following three scenarios:</p>
<ul>
<li><p>You have a data set and wish to perform an analysis on only males.</p></li>
<li><p>All missing values have been coded as 99, 888, or 999.</p></li>
<li><p>A scatterplot reveals several outliers, and you need to identify the cases corresponding to the outliers.</p></li>
</ul>
<p>In each scenario, <code>which</code> can be used to select the appropriate subset of the data.</p>
</section>
</section>
</section>
<section id="student-t-tests" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Student t-tests</h1>
<p>A t-test is a statistical hypothesis test in which the test statistic follows a t-distribution. Three common applications of the t-test are:</p>
<ul>
<li><p>A one-sample t-test of whether the mean of a normally distributed population is a particular value (<span class="math inline">\(H_0: \mu = 70\)</span>)</p></li>
<li><p>An independent samples t-test to determine whether the means of two normally distributed populations are equal (<span class="math inline">\(H_0: \mu_1 = \mu_2\)</span>)</p></li>
<li><p>A paired samples t-test to determine whether the means of two normally distributed populations are equal (<span class="math inline">\(H_0: \mu_1 = \mu_2\)</span>)</p></li>
</ul>
<p>Another t-test arises when testing whether a regression parameter equals 0 (<span class="math inline">\(H_0: \beta_1 = 0\)</span>).</p>
<section id="one-sample-t-test" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="one-sample-t-test"><span class="header-section-number">6.1</span> One-sample t-test</h2>
<p>Clean up the workspace and import <code>height.csv</code> into <strong><span class="sans-serif">R</span></strong>.</p>
<p><code>&gt; rm(list=ls()) # removes all objects</code></p>
<p><code>&gt; dat = read.csv("height.csv", header=TRUE)</code></p>
<p><code>&gt; head(dat)</code></p>
<p>Let’s start with a one-sample t-test. Test the hypothesis that the population mean height for men is 70 inches (<span class="math inline">\(H_0:\mu_{men} = 70\)</span>)</p>
<p>First we need to get the subset where gender <span class="math inline">\(==\)</span> male.</p>
<p><code>&gt; dat$gender == "male"</code></p>
<p><code>&gt; men.ht = dat$height[dat$gender == "male"]</code></p>
<p>Before doing any formal analyses, it is always a good idea to summarize the data both numerically and visually.</p>
<p><code>&gt; summary(men.ht)</code></p>
<p><code>&gt; boxplot(men.ht)</code></p>
<p><code>&gt; hist(men.ht, main="My First Histogram in R!")</code></p>
<p>The <code>t.test</code> function will perform a one sample t-test for the height of men. Suppose we wish to test the hypothesis <span class="math inline">\(H_0: \mu_{men} = 70\)</span> versus the alternative <span class="math inline">\(H_a: \mu_{men} \neq 70\)</span>. We must give the <code>t.test</code> function 1) the vector of male height values, and 2) the value of the mean under the null hypothesis. The default alternative is two-sided.</p>
<p><code>&gt; t.test(men.ht, mu=70)</code></p>
<p>What if you want to calculate a 90% confidence interval?</p>
<p><code>&gt; help(t.test)</code></p>
<p>The <em>conf.level</em> argument will be used to change the confidence level.</p>
<p><code>&gt; t.test(men.ht, mu=70, conf.level= 0.90)</code></p>
<p><code>&gt; t.out = t.test(men.ht, mu=70, conf.level= 0.90)</code></p>
<p><code>&gt; names(t.out)</code></p>
<p><code>&gt; t.out$conf.int</code></p>
</section>
<section id="independent-samples-t-tests" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="independent-samples-t-tests"><span class="header-section-number">6.2</span> Independent Samples t-tests</h2>
<p>Now suppose we wish to test whether there is a difference between the population mean heights for men and women (<span class="math inline">\(H_0: \mu_m = \mu_w\)</span>). Before running the t-test, let’s make side-by-side boxplots to visually compare the heights of men and women.</p>
<p><code>&gt; boxplot(men.ht, women.ht)</code></p>
<section id="the-formula-operator-sim" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="the-formula-operator-sim"><span class="header-section-number">6.2.1</span> The formula operator (<span class="math inline">\(\sim\)</span>)</h3>
<p>It is possible to avoid creating separate vectors for two groups that you would like to compare. This is done with the formula operator and many R functions can accept a formula as the first argument. The second argument must then nearly always be the data.frame where the formula should be evaluated.</p>
<p><code>&gt; boxplot(height</code><span class="math inline">\(\sim\)</span><code>gender, data=dat)</code></p>
<p>If you don’t include the data argument, you’ll likely get an error message:</p>
<p><code>&gt; boxplot(height</code><span class="math inline">\(\sim\)</span><code>gender)</code> # error: data not found?</p>
<p>The variables in the <code>dat</code> data.frame can be made available temporarily by wrapping the command inside a call to <code>with</code>:</p>
<p><code>&gt; with(dat, boxplot(height</code><span class="math inline">\(\sim\)</span><code>gender))</code></p>
<p>If you need access to the variables in a data.frame for an extended session and you aren’t going to change the variables in the data.frame, you can use the <code>attach(dat)</code> function to access height and gender directly. However, using <code>attach</code> is discouraged by some analysts. It puts a second copy of the data.frame on the “search path” and can make updating your data tricky. <strong>Remember to <code>detach</code> when you are done.</strong></p>
<p><code>&gt; height</code></p>
<p><code>&gt; attach(dat)</code></p>
<p><code>&gt; height</code></p>
<p><code>&gt; detach(dat)</code></p>
<p><code>&gt; height</code></p>
<p>Now perform the independent samples t-test.</p>
<p><code>&gt; t.test(height</code><span class="math inline">\(\sim\)</span><code>gender, data=dat)</code></p>
</section>
</section>
</section>
<section id="chi-square-tests" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Chi-Square tests</h1>
<p>Pearson’s chi-square test is used to make two types of comparisons for categorical variables. A <em>goodness of fit test</em> determines whether a particular hypothesized distribution is reasonable for a categorical variable. A <em>test of independence</em> assesses whether two categorical variables are independent of each other.</p>
<section id="goodness-of-fit" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="goodness-of-fit"><span class="header-section-number">7.1</span> Goodness of Fit</h2>
<p>Suppose a company wants to determine if employees are equally likely to call in sick on any day of the week. That is, test the hypothesis <span class="math display">\[H_0: p_1 = p_2 = p_3 = p_4 = p_5\]</span> where <span class="math inline">\(p_1\)</span> represents the probability that a random call-in sick occurs on Monday, etc. The employer collects data and obtains the following table</p>
<div class="center">
<table class="table">
<tbody>
<tr class="odd">
<td style="text-align: right;">Mon</td>
<td style="text-align: right;">Tue</td>
<td style="text-align: right;">Wed</td>
<td style="text-align: right;">Thu</td>
<td style="text-align: right;">Fri</td>
</tr>
<tr class="even">
<td style="text-align: right;">34</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">26</td>
</tr>
</tbody>
</table>
</div>
<p>If <span class="math inline">\(H_0\)</span> is true, the expected value in cell <span class="math inline">\(i\)</span> is <span class="math inline">\(E_i = np_i\)</span>, where <span class="math inline">\(n = 34 + 18 + 19 + 12 + 26 = 109\)</span> and <span class="math inline">\(p_i = 0.2\)</span>. The differences between the observed and expected values are combined into the <span class="math inline">\(\chi^2\)</span> statistic. <span class="math display">\[\chi^2 = \sum_i\frac{(O_i - E_i)^2}{E_i}\]</span> If the null hypothesis is true, the <span class="math inline">\(\chi^2\)</span> statistic approximately follows a <span class="math inline">\(\chi^2(k-1)\)</span> distribution, where <span class="math inline">\(k\)</span> is the number of groups (5). This approximation is poor if the expected value in any cell is small.</p>
<p>We first need to get the data into <strong><span class="sans-serif">R</span></strong>.</p>
<p><code>&gt; days = c(34, 18, 19, 12, 26)</code></p>
<p><code>&gt; names(days) = c("Mon", "Tue", "Wed", "Thu", "Fri")</code></p>
<p><code>&gt; days</code></p>
<p>Many chi-square tests are performed using the <code>chisq.test</code> function.</p>
<p><code>&gt; chisq.test(days)</code></p>
<p><strong><span class="sans-serif">R</span></strong> returns the <span class="math inline">\(\chi^2\)</span> test statistic, the degrees of freedom, and the p-value. Notice that we didn’t specify that we were testing the hypothesis that were testing the hypothesis of <em>equal</em> probabilities. By default, <code>chisq.test</code> assumes a test of equal probabilities unless the user specifies otherwise. If, for some reason, we wanted to test the hypothesis that <span class="math inline">\(p_1 = 0.35\)</span>, <span class="math inline">\(p_2 = 0.1\)</span>, <span class="math inline">\(p_3 = 0.1\)</span>, <span class="math inline">\(p_4 = 0.1\)</span>, <span class="math inline">\(p_5 = 0.35\)</span>, we can do so by passing the probabilities to <code>chisq.test</code> in this way.</p>
<p><code>&gt; chisq.test(days, p=c(0.35, 0.1, 0.1, 0.1, 0.35))</code></p>
<p>So far, the output for the chi-square tests have been limited. What if we wanted to obtain expected values or cell residuals? We unleash more of <strong><span class="sans-serif">R</span></strong>’s capabilities by storing the value of the test as an object.</p>
<p><code>&gt; cs.test = chisq.test(days)</code></p>
<p><code>&gt; names(cs.test)</code></p>
<p><code>&gt; cs.test$expected</code></p>
<p><code>&gt; cs.test$statistic</code></p>
<p><code>&gt; cs.test$residuals</code></p>
</section>
<section id="chi-square-test-of-independence" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="chi-square-test-of-independence"><span class="header-section-number">7.2</span> Chi-Square Test of Independence</h2>
<p>A Chi-Square Test of Independence tests for a relationship between two categorical variables. We will use the “UCBAdmissions data set” to illustrate.</p>
<p><code>&gt; data()</code></p>
<p><code>&gt; UCBAdmissions</code></p>
<p><code>&gt; class(UCBAdmissions)</code></p>
<p><code>&gt; dim(UCBAdmissions)</code></p>
<p>Let’s select the second 2 by 2 table to perform a chi-square test of independence.</p>
<p><code>&gt; dat = UCBAdmissions[,,2]</code></p>
<p><code>&gt; dat</code></p>
<p>When we pass a vector of values to <code>chisq.test</code>, a test of homogeneity is performed by default. When we pass a table or matrix, a test of independence is performed.</p>
<p><code>&gt; chisq.test(dat)</code></p>
<p>The default in <strong><span class="sans-serif">R</span></strong> is to use Yates’ continuity correction for 2x2 tables. You can opt not to use it.</p>
<p><code>&gt; chisq.test(dat, correct=FALSE)</code></p>
</section>
<section id="fishers-exact-test" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="fishers-exact-test"><span class="header-section-number">7.3</span> Fisher’s Exact Test</h2>
<p>Pearson Chi-Square tests rely on an approximation that becomes poor as cell sizes get small. With smaller samples, Fisher’s Exact Test might be a good alternative. However, there are many flavors of Fisher’s test. <strong><span class="sans-serif">R</span></strong> has implemented many of them, including one in the base package.</p>
<p><code>&gt; fisher.test(dat)</code></p>
</section>
</section>
<section id="linear-models" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Linear Models</h1>
<p>In a Linear Model, the expected value (mean) of a response variable, <span class="math inline">\(Y\)</span>, is modeled as a linear combination of one or more predictors. The usual formulation of a linear model is as follows. <span class="math display">\[E[Y] = \beta_0 + \beta_1X_1 + ... + \beta_pX_p\]</span> We can also write down a version of the model that includes a random component. <span class="math display">\[Y = \beta_0 + \beta_1X_1 + ... + \beta_pX_p + \epsilon\]</span></p>
<p><strong>Examples of Linear Models</strong></p>
<ul>
<li><p>Simple Linear Regression – only one predictor</p></li>
<li><p>ANOVA – the predictors are dummy variables representing group membership</p></li>
<li><p>Multiple Linear Regression – the predictors can be any combination of binary, nominal, ordinal, and continuous</p></li>
</ul>
<p>Even an independent samples t-test is an example of a linear model. In this case, there is only one predictor, <span class="math inline">\(X\)</span>, which is a dummy variable representing the group.</p>
<section id="another-example-of-data-entry" class="level3" data-number="8.0.1">
<h3 data-number="8.0.1" class="anchored" data-anchor-id="another-example-of-data-entry"><span class="header-section-number">8.0.1</span> Another example of data entry</h3>
<p>The <em>linmod.csv</em> data set contains the following measurements on 255 individuals.</p>
<ul>
<li><p>Systolic Blood Pressure</p></li>
<li><p>Diastolic Blood Pressure</p></li>
<li><p>Combined Blood Pressure</p></li>
<li><p>Age</p></li>
<li><p>Gender</p></li>
<li><p>Smoking Status</p></li>
</ul>
<p>We begin by reading in the data.</p>
<p><code>&gt; dat = read.csv("linmod.csv", header=TRUE)</code></p>
<p>Before beginning any modeling, it’s important to investigate the data to make sure it is there as you expect. If we just type <code>dat</code> at the command line, <strong><span class="sans-serif">R</span></strong> prints the entire data set. This is not the most efficient way to explore the data. Here we explore several different ways of exploring the data set in a more concise manner.</p>
<p>The <code>dim</code> function returns the dimensions of the data set; the <code>head</code> and <code>tail</code> functions enables us to see the first and last rows of the data set.</p>
<p><code>&gt; class(dat)</code></p>
<p><code>&gt; names(dat)</code></p>
<p><code>&gt; dim(dat)</code></p>
<p><code>&gt; head(dat)</code></p>
<p><code>&gt; head(dat, 15)</code></p>
<p><code>&gt; tail(dat)</code></p>
<p>The <code>summary</code> function is a powerful method for summarizing variables in the data set.</p>
<p><code>&gt; summary(dat)</code></p>
<p>The output includes a numeric summary for the variables <em>sbp</em> and <em>dbp</em>. The <em>bp</em> column is read as <em>character</em> (and converted to a factor) because it contains the character “/”. Instead of a numeric summary for <em>bp</em>, <code>summary</code> returns a table of values for the factor levels.</p>
<p>We would expect <em>age</em> to be a continuous variable, but <strong><span class="sans-serif">R</span></strong> returns a table summary for <em>age</em> rather than a numeric summary. This indicates that <em>age</em> is being read as a factor, and we should check for strings in the age column. In the <em>smoke</em> column, we see that one person has the value <span class="math inline">\(888\)</span> and two the value <span class="math inline">\(999\)</span>.</p>
<p>Another powerful function for investigating the structure of a data set is the <code>str</code> command.</p>
<p><code>&gt; str(dat)</code></p>
<p>The output lists <em>age</em> as a <em>factor</em> which confirms our suspicion that <em>age</em> is being read as a character variable. For factors, we can investigate the factor levels with the <code>levels</code> command.</p>
<p><code>&gt; levels(dat$age)</code></p>
<p>Someone has recorded “Not Reported" in the age column for one person. With a data set as small as ours, we could type <code>dat</code> and scroll down to find out which person had a”Not Reported" for age. With large data sets this is difficult. The <code>which</code> statement is another option.</p>
<p><code>&gt; which(dat$age == "Not Reported")</code></p>
<p><code>&gt; dat[which(dat$age == "Not Reported"), ]</code></p>
<p>Now let’s investigate the <em>smoke</em> variable.</p>
<p><code>&gt; levels(dat$smoke)</code></p>
<p><code>&gt; which(dat$smoke == "888")</code></p>
<p><code>&gt; which(dat$smoke == "999")</code></p>
<p><strong>Fixing the Data</strong> Suppose that 888 and 999 and “Not Reported” all indicate missing values. Let’s update the <em>age</em> and <em>smoke</em> variables by putting NA to represent missingness.</p>
<p><code>&gt; dat$age[189] = NA</code></p>
<p><code>&gt; dat$smoke[c(83,80,91)] = NA</code></p>
<p><code>&gt; summary(dat$smoke)</code></p>
<p><code>&gt; dat$smoke = factor(dat$smoke)</code></p>
<p><code>&gt; summary(dat$smoke)</code></p>
<p><strong>Common Data Management Problem!</strong></p>
<p>We still need to change <em>age</em> to a numeric variable. Just using <code>as.numeric</code> won’t work on <em>factors</em>.</p>
<p><code>&gt; as.numeric(dat$age)</code></p>
<p>Instead, we must first change it to character and then numeric.</p>
<p><code>&gt; as.numeric(as.character(dat$age))</code></p>
<p><code>&gt; dat$age = as.numeric(as.character(dat$age))</code></p>
</section>
<section id="solution" class="level3" data-number="8.0.2">
<h3 data-number="8.0.2" class="anchored" data-anchor-id="solution"><span class="header-section-number">8.0.2</span> Solution</h3>
<p>Another alternative is to read the data set using the <code>na.strings</code> argument.</p>
<p><code>&gt; dat = read.csv("linmod.csv", na.strings=c("NA","Not Reported","888","999"))</code></p>
<p><strong>Graphical Descriptions of Blood Pressure</strong> Let’s start by examining the marginal distribution of Systolic Blood Pressure.</p>
<p><code>&gt; hist(dat$sbp, main="Histogram of Systolic Blood Pressure", xlab="Systolic BP")</code></p>
<p><code>&gt; boxplot(dat$sbp, main="Boxplot of SBP", ylab="SBP")</code></p>
<p>Now use the <code>plot</code> function to create a scatterplot of Systolic Blood Pressure versus Diastolic Blood Pressure. Suppose we want Diastolic Blood Pressure on the horizontal axis and Systolic Blood Pressure on the vertical axis. The horizontal axis is the first argument and the vertical axis is the second argument.</p>
<p><code>&gt; plot(sbp</code><span class="math inline">\(\sim\)</span><code>dbp, data=dat)</code></p>
<p><code>plot</code> has many arguments which will allow us to modify the graph. Let’s take a look at a few of them.</p>
<p><code>&gt; plot(sbp</code><span class="math inline">\(\sim\)</span><code>dbp, data=dat, col="green")</code></p>
<p><code>&gt; plot(sbp</code><span class="math inline">\(\sim\)</span><code>dbp, data=dat, pch=2, col="green")</code></p>
<p><code>&gt; plot(sbp</code><span class="math inline">\(\sim\)</span><code>dbp, data=dat, pch=2, xlab="Diastolic",</code></p>
<p><code>+ ylab="Systolic", main="Blood Pressure", col="green")</code></p>
<p><strong>Numerical Descriptions of Blood Pressure</strong> Using the <code>sd</code>, <code>cov</code>, and <code>cor</code> functions, we can investigate the marginal and joint variation of Diastolic and Systolic Blood Pressure.</p>
<p><code>&gt; summary(dat$dbp)</code></p>
<p><code>&gt; summary(dat$sbp)</code></p>
<p><code>&gt; sd(dat$dbp)</code></p>
<p><code>&gt; sd(dat$sbp)</code></p>
<p><code>&gt; cov(dat$dbp, dat$sbp)</code></p>
<p><code>&gt; cor(dat$dbp, dat$sbp)</code></p>
</section>
<section id="simple-linear-regression-using-the-lm-function" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="simple-linear-regression-using-the-lm-function"><span class="header-section-number">8.1</span> Simple Linear Regression using the <code>lm</code> function</h2>
<p>In a simple linear regression, we propose the model: <span class="math display">\[Y = \beta_0 + \beta_1 X + \epsilon,\]</span> where <span class="math inline">\(Y\)</span> is the dependent variable, <span class="math inline">\(X\)</span> is the sole independent variable, and <span class="math inline">\(\epsilon\)</span> represents a random component. One of the goals in a simple linear regression is to find the estimates, <span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta_1}\)</span>, that fit the data best.</p>
<p>The <strong><span class="sans-serif">R</span></strong> function used to fit regression models is the <code>lm</code> function. Let’s begin by doing a simple linear regression of systolic blood pressure on diastolic blood pressure.</p>
<p><code>&gt; lm(sbp</code><span class="math inline">\(\sim\)</span><code>dbp, data=dat)</code></p>
<p>At first glance, <strong><span class="sans-serif">R</span></strong> returns the estimated regression parameters <span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta_1}\)</span> but very little else. What about the model <span class="math inline">\(r^2\)</span>? How do we find the residuals? What about confidence intervals, influential points, or the other diagnostics one should consider when performing a regression analysis?</p>
<p>By storing the fitted model as an object, we are able to unleash all the power in the <code>lm</code> function. Let’s try again, but this time, store the linear model as an object.</p>
<p><code>&gt; mymod = lm(sbp</code><span class="math inline">\(\sim\)</span><code>dbp, data=dat)</code></p>
<p>The variable <code>mymod</code> now stores the information from the regression of <code>sbp</code> on <code>dbp</code>. <code>mymod</code> is a linear model object. Just as we earlier saw examples of numeric objects (<code>x = 5</code>) and character objects (<code>y = "Hi"</code>), we now have the object <code>mymod</code> which is a linear model object. Let’s verify that <code>mymod</code> is a linear model object.</p>
<p><code>&gt; class(mymod)</code></p>
<p>Now that we have the “lm" object stored in <code>mymod</code>, let’s do some more investigation.</p>
<p><code>&gt; summary(mymod)</code></p>
<p>The <code>summary</code> function returns the following</p>
<ul>
<li><p>A 5-number summary of the residuals</p></li>
<li><p>A table of regression coefficients, standard errors, t-statistics, and p-values for testing the hypotheses that <span class="math inline">\(\beta_i = 0\)</span></p></li>
<li><p>An estimate of the error standard deviation</p></li>
<li><p>Unadjusted and adjusted model <span class="math inline">\(r^2\)</span></p></li>
<li><p>An overall F-test of no model effect</p></li>
</ul>
<p>We can use the names function to see everything that is stored in <code>mymod</code>.</p>
<p><code>&gt; names(mymod)</code></p>
<p>We can extract any single attribute using $.</p>
<p><code>&gt; mymod$coefficients</code></p>
<p><code>&gt; mymod$fitted.values</code></p>
<p><strong><span class="sans-serif">R</span></strong> has many “extractor” functions:</p>
<p><code>&gt; coef(mymod)</code></p>
<p><code>&gt; fitted(mymod)</code></p>
<p><strong><span class="sans-serif">R</span></strong> also has powerful graphing tools for checking model assumptions. For a simple linear regression, we need to check for</p>
<ul>
<li><p>The nature of the relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> (linear?)</p></li>
<li><p>The error distribution</p></li>
<li><p>Influential points</p></li>
</ul>
<p>Using the <code>plot</code> function, we can cycle through diagnostic graphs to test each of the above assumptions.</p>
<p><code>&gt; plot(residuals(mymod), predict(mymod), main="Residual Plot")</code></p>
<p>Confidence intervals for the regression coefficients provide much more information than p-values. Confidence intervals for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> can be generated using the <code>confint</code> function.</p>
<p><code>&gt; confint(mymod)</code></p>
<p><code>&gt; confint(mymod, level=.90)</code></p>
<p>We can also examine the ANOVA table associated with the regression model.</p>
<p><code>&gt; anova(mymod)</code></p>
</section>
<section id="analysis-of-variance" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="analysis-of-variance"><span class="header-section-number">8.2</span> Analysis of Variance</h2>
<p>Suppose one wishes to do a 2-way ANOVA model, where diastolic blood pressure is the response with gender and smoking status the two factors. As always, it is important to begin by investigating the relationships graphically.</p>
<p><code>&gt; boxplot(dbp</code><span class="math inline">\(\sim\)</span><code>smoke, data=dat)</code></p>
<p><code>&gt; boxplot(dbp</code><span class="math inline">\(\sim\)</span><code>gen, data=dat)</code></p>
<p><code>&gt; with(dat, interaction.plot(smoke, gen, dbp))</code></p>
<p>Since an ANOVA model is simply a linear model where the only predictors are dummy variables representing group membership, ANOVA models can be fit using the <code>lm</code> function.</p>
<p><code>&gt; lm.mod = lm(dbp</code><span class="math inline">\(\sim\)</span><code>gen + smoke, data=dat)</code></p>
<p><code>&gt; summary(lm.mod)</code></p>
<p>Many researchers prefer output organized in a different ANOVA table. We can also use the <code>aov</code> function to fit an ANOVA model.</p>
<p><code>&gt; aov.mod = aov(dbp</code><span class="math inline">\(\sim\)</span><code>gen + smoke, data=dat)</code></p>
<p><code>&gt; summary(aov.mod)</code></p>
<p><code>lm.mod</code> and <code>aov.mod</code> represent the same fit but the <code>summary</code> function reports them differently. <code>summary</code> is an example of a generic function. Different versions are used for different classes. Remember that we used <code>summary</code> earlier to describe numeric vectors, factors, and data.frames. Let’s investigate the class of the two models.</p>
<p><code>&gt; class(lm.mod)</code></p>
<p><code>&gt; class(aov.mod)</code></p>
<p>The following commands give the mean of the dependent variable and each factor level:</p>
<p><code>&gt; model.tables(aov.mod)</code></p>
<p><code>&gt; ?model.tables</code></p>
<p>We can use Tukey’s HSD procedure to test the pairwise differences, adjusting for multiple testing:</p>
<p><code>&gt; TukeyHSD(aov.mod)</code></p>
<p><code>&gt; ?TukeyHSD</code></p>
</section>
<section id="multiple-linear-regression" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="multiple-linear-regression"><span class="header-section-number">8.3</span> Multiple Linear Regression</h2>
<p>A multiple linear regression assumes the following relationship: <span class="math display">\[Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + ... + \beta_pX_p + \epsilon\]</span> In this notation, <span class="math inline">\(Y\)</span> represents the response variable of interest, and the <span class="math inline">\(X_j\)</span> correspond to predictor variables. When fitting a linear regression model, one aim to estimate the <span class="math inline">\(\beta\)</span> parameters. The fitted model is sometimes used to predict future responses.</p>
<p>We will use the built-in LifeCycleSavings data set (which we saw in passing earlier) to illustrate fitting a multiple linear regression. We will use the popular <code>car</code> (Companion to Applied Regression) package for some regression diagnostics.</p>
<p><code>&gt; data()</code></p>
<p>Let’s first begin by learning about the data set.</p>
<p><code>&gt; help(LifeCycleSavings)</code></p>
<p>Shorten the name.</p>
<p><code>&gt; Life=LifeCycleSavings</code></p>
<p>Now let’s make a boxplot of each of the five variables. For comparison, it would be helpful to view all of the plots on the same output. The <code>par</code> and <code>mfrow</code> commands are useful for this. The <code>par</code> function allows you to set graphical parameters, and <code>mfrow</code> allows you to specify an array of plots.</p>
<p>The following commands set up a two by two grid of plots.</p>
<p><code>&gt; par(mfrow=c(2,2))</code></p>
<p>We can add boxplots one at a time.</p>
<p><code>&gt; boxplot(Life$sr, main="sr")</code></p>
<p><code>&gt; boxplot(Life$pop15, main="pop15")</code></p>
<p><code>&gt; boxplot(Life$pop75, main="pop75")</code></p>
<p><code>&gt; boxplot(Life$dpi, main="dpi")</code></p>
<p>After exploring the marginal relationships of each of the variables, it is a good idea to investigate the bivariate relationships. We do this both numerically and graphically.</p>
<p><code>&gt; cor(Life)</code></p>
<p><code>&gt; pairs(Life, panel=panel.smooth)</code></p>
<p>Now fit a multiple regression model using the <code>lm</code> function.</p>
<p><code>&gt; mr.mod = lm(sr</code><span class="math inline">\(\sim\)</span><code>pop15 + pop75 + dpi + ddpi, data=Life)</code></p>
<p><code>&gt; summary(mr.mod)</code></p>
<p><code>&gt; confint(mr.mod)</code></p>
<p>We saw that there was a large negative correlation between pop75 and pop15. One diagnostic for multicolinearity is the variance inflation factor (VIF). Let’s investigate the variance inflation factors. It has been implemented in the <code>car</code> package. To access the function we must load the package:</p>
<p><code>&gt; library(car)</code></p>
<p><code>&gt; ?vif</code></p>
<p><code>&gt; vif(mr.mod)</code></p>
<p>How does the model change if we leave out one of the variables? We fit a different model removing pop75.</p>
<p><code>&gt; mr.mod2 = lm(sr</code><span class="math inline">\(\sim\)</span><code>pop15 + dpi + ddpi, data=Life)</code></p>
<p>We now perform an F test for nested models.</p>
<p><code>&gt; anova(mr.mod, mr.mod2, test="F")</code></p>
</section>
</section>
<section id="lists" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Lists</h1>
<section id="string-manipulation" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="string-manipulation"><span class="header-section-number">9.1</span> String Manipulation</h2>
<p>In the third column of <em>dat</em>, systolic and diastolic pressure were placed together separated by a “/”. Ideally, data would never be stored in such a manner. For easy data processing, systolic and diastolic blood pressure should be stored in separate columns. Although in our data sets we did have separate columns, suppose for the sake of example that we only had the one column in which blood pressure was entered as <span class="math inline">\(120/82\)</span>. It could be time consuming to convert these to separate variables by hand in Excel.</p>
<p>Fortunately, <strong><span class="sans-serif">R</span></strong> has excellent string manipulation facilities. In this example, we will use the <code>strsplit</code> function to extract diastolic and systolic blood pressures. <code>strsplit</code> has two arguments that we will use. The first argument is the character string we wish to split. The second argument is the character that we will split on. Let’s start with the <em>bp</em> value in the first row.</p>
<p><code>&gt; b = dat$bp[1]</code></p>
<p><code>&gt; b</code></p>
<p>Now let’s try to split <code>b</code> into two separate values.</p>
<p><code>&gt; strsplit(b, split="/")</code></p>
<p>This didn’t work. When a problem like this arises, be sure to look at the error messages! In this example, <strong><span class="sans-serif">R</span></strong> complains that we have a “non-character" argument. Let’s investigate.</p>
<p><code>&gt; class(b)</code></p>
<p>Sure enough, b is a factor since it was obtained by indexing a factor in the data set. We must first change b to a character.</p>
<p><code>&gt; b = as.character(b)</code></p>
<p><code>&gt; class(b)</code></p>
<p>Now we are ready!</p>
<p><code>&gt; strsplit(b, split="/")</code></p>
<p>This seems to work, but in order to use the separated values, we must first store the split string as an object.</p>
<p><code>&gt; sep = strsplit(b, split="/")</code></p>
<p><code>&gt; sep</code></p>
<p><code>&gt; class(sep)</code></p>
</section>
<section id="lists-1" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="lists-1"><span class="header-section-number">9.2</span> Lists</h2>
<p>The object <code>sep</code> is a list, a class of objects that we have not yet encountered explicitly (however, data.frames are lists). Lists can simultaneously store many objects of various classes. Recall from earlier that elements of a vector were forced to be of the same class (e.g., character). Lists are much more flexible and can contain characters, vectors, matrices, data.frames, and even other lists. Let’s take a detour from our original problem of separating blood pressures in order to investigate lists.</p>
<p>Create a list containing a single number, a character, and a vector of number.</p>
<p><code>&gt; L = list(5, "Hi", c(3,8,7))</code></p>
<p><code>&gt; L</code></p>
<p>The syntax for indexing lists is different than that for vectors or matrices. If we type <code>L[1]</code>, we obtain the sub-list containing 5 instead of just the number 5.</p>
<p><code>&gt; L[1]</code></p>
<p><code>&gt; class(L[1])</code></p>
<p>Instead, we must use double-brackets to extract the number 5 rather than the sublist containing the number 5.</p>
<p><code>&gt; L[[1]]</code></p>
<p><code>&gt; class(L[[1]])</code></p>
<p>The following extracts the 8 from the third element of the list.</p>
<p><code>&gt; L[[3]][2]</code></p>
<p>Now that we have a basic understanding of lists. Let’s return to our problem of separating diastolic and systolic blood pressure.</p>
<p><code>&gt; sep</code></p>
<p><code>&gt; s = sep[[1]][1]</code></p>
<p><code>&gt; d = sep[[1]][2]</code></p>
<p><code>&gt; s</code></p>
<p><code>&gt; d</code></p>
<p><code>&gt; s = as.numeric(s)</code></p>
<p><code>&gt; d = as.numeric(d)</code></p>
<p><code>&gt; s</code></p>
<p><code>&gt; d</code></p>
<p>It worked! Now we need to do this for every person. One way this can be accomplished is with a <code>for</code> loop or <code>*apply</code>. We will revisit this after covering programming. You can try the following but more is needed.</p>
<p><code>&gt; strsplit(as.character(dat$bp), split="/")</code></p>
</section>
</section>
<section id="generalized-linear-models-glm" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Generalized Linear Models (GLM)</h1>
<p>In practice, GLMs are often used when the response variable is not continuous. Several examples of GLMs include</p>
<ul>
<li><p>Logistic Regression (Y is binary)</p></li>
<li><p>Multinomial Logistic Regression (Y is nominal)</p></li>
<li><p>Poisson Regression (Y is a count)</p></li>
<li><p>Negative Binomial Regression (Y is a count with over-dispersion)</p></li>
</ul>
<p><strong><span class="sans-serif">R</span></strong> uses the function <code>glm</code> to fit GLMs. We will use logistic regression to illustrate <code>glm</code>.</p>
<section id="logistic-regression" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="logistic-regression"><span class="header-section-number">10.1</span> Logistic Regression</h2>
<p>Logistic regression is a specific type of GLM used to model a binary outcome. If we label a success “1” and a failure “0”, the <em>odds</em> of success are defined as <span class="math inline">\(P(Y=1)/P(Y=0)\)</span>. Logistic regression models the log odds of success as a linear combination of the predictors. <span class="math display">\[{\rm log}\left(\frac{P(Y=1|X)}{P(Y=0|X)}\right) =  \beta_0 + \beta_1X_1 + ... + \beta_pX_p\]</span></p>
<p>In logistic regression, <span class="math inline">\(\beta_i\)</span> is the effect of <span class="math inline">\(X_i\)</span> on the log odds of success (<span class="math inline">\(Y=1\)</span>).</p>
<p>For an example, we use the “Mroz" data in the <em>car</em> library. Let’s first review the”Mroz” data set.</p>
<p><code>&gt; library(car)</code></p>
<p><code>&gt; help(Mroz)</code></p>
<p>The syntax for <code>glm</code> is nearly the same as the syntax for <code>lm</code>. One important additional argument is <em>family</em>, which specifies what type of GLM will be fit. Logistic regression models a binary response, so we use the binomial family.</p>
<p><code>&gt; mroz.mod = glm(lfp</code><span class="math inline">\(\sim\)</span><code>I(k5==0) + age + wc + hc + lwg + inc, data=Mroz,</code></p>
<p><code>+ &nbsp;&nbsp;family=binomial)</code></p>
<p><code>&gt; summary(mroz.mod)</code></p>
<p>The fitted object <code>mroz.mod</code> is of a new type of class.</p>
<p><code>&gt; class(mroz.mod)</code></p>
<p>We can extract the estimated coefficients using <code>coef</code>.</p>
<p><code>&gt; coef(mroz.mod)</code></p>
<p>When reporting the effects of a logistic regression analysis, it is common to include the effect on the <em>odds</em> of success. Since <span class="math inline">\(\beta_i\)</span> is the effect of <span class="math inline">\(X_i\)</span> on the log odds of success, <span class="math inline">\(e^{\beta_i}\)</span> is the effect of <span class="math inline">\(X_i\)</span> on the odds of success<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. We can estimate the effects of the predictors on the odds by exponentiating the coefficients.</p>
<p><code>&gt; exp(coef(mroz.mod))</code></p>
<p>We can also obtain confidence intervals for both the log odds and odds effects.</p>
<p><code>&gt; confint(mroz.mod)</code></p>
<p><code>&gt; exp(confint(mroz.mod))</code></p>
</section>
</section>
<section id="creating-functions" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Creating Functions</h1>
<p>Another very nice feature of <strong><span class="sans-serif">R</span></strong> is the ability to easily write your own programs and functions. We will begin by creating a new function called <code>add.machine</code> that will simply sum two numbers:</p>
<p><code>add.machine</code><span class="math inline">\(=\)</span><code>function(num1, num2){</code><br>
<code>result</code><span class="math inline">\(=\)</span><code>num1</code><span class="math inline">\(+\)</span><code>num2</code><br>
<code>return(result)</code><br>
<code>}</code></p>
<p>The following are important components of the code above:</p>
<ul>
<li><p><code>add.machine</code> is the name of the newly created object</p></li>
<li><p><code>function</code> declares that <code>add.machine</code> will be a function</p></li>
<li><p><code>num1</code> and <code>num2</code> are the arguments that <code>add.machine</code> will take as input</p></li>
<li><p>The body of the function is enclosed in curly braces</p></li>
<li><p><code>return</code> (is optional) but specifies the output that is returned from the function</p></li>
</ul>
<p>Let’s test out the newly created function</p>
<p><code>&gt; add.machine</code></p>
<p><code>&gt; add.machine(3,5)</code></p>
<p>What happens if we don’t specify valid arguments?</p>
<p><code>&gt; add.machine(3)</code></p>
<p><code>&gt; add.machine(3, "Hi")</code></p>
</section>
<section id="programming" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Programming</h1>
<p>Programming in <strong><span class="sans-serif">R</span></strong> is basically the same as programming in any other language; the core program is controlled by a series of if-then statements, loops, print statements, calls to other programs, and return statements. The only differences are minor syntax conventions that just take practice.</p>
<section id="branching" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="branching"><span class="header-section-number">12.1</span> Branching</h2>
<p>To begin with, let’s look at an example of how if-then statements work in <strong><span class="sans-serif">R</span></strong>. Try submitting this command at the prompt to see how it works:</p>
<p><code>&gt; if (1&gt;0) print("I Like Binary")</code></p>
<p>Note that <strong><span class="sans-serif">R</span></strong> prints “I Like Binary" because the condition in the <em>if</em> statement is true. The <code>print</code> function is very useful for programming purposes, in that it prints simple strings in the <strong><span class="sans-serif">R</span></strong> Console. No explicitly labeled <em>then</em> statement is needed after an <em>if</em> statement; you simply type what you would like <strong><span class="sans-serif">R</span></strong> to do if the <em>if</em> condition is true. In general, if you want to do more than one thing if the <em>if</em> condition is true, you use this bracketed structure:</p>
<p><code>if (logical condition)&nbsp;{</code><br>
<code>do this</code><br>
<code>and this</code><br>
<code>and this</code><br>
<code>}</code></p>
<p>The statements in the brackets usually refer to function calls and object assignments, and simply need to be on separate lines (no punctuation necessary!). If necessary, you can use an “else” option:</p>
<p><code>&gt; if (x&gt;5) print("x is big") else print("x is small")</code></p>
</section>
<section id="looping" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="looping"><span class="header-section-number">12.2</span> Looping</h2>
<p>Now let’s take a look at how a “for” loop works in <strong><span class="sans-serif">R</span></strong>. Try submitting the following syntax at the command prompt:</p>
<p><code>&gt; for (i in 1:5) print(i)</code></p>
<p><strong><span class="sans-serif">R</span></strong> prints 1, 2, 3, 4, and 5. <em>For</em> loops work like <em>if</em> conditions, and if you want <strong><span class="sans-serif">R</span></strong> to do more than one thing in a <em>for</em> loop, use brackets around the commands:</p>
<p><code>for(i in a:b)&nbsp;{</code><br>
<code>do this</code><br>
<code>and this</code><br>
<code>and this</code><br>
<code>}</code></p>
<p><code>while</code> and <code>repeat</code> loops in <strong><span class="sans-serif">R</span></strong> work in a manner very similar to other programming languages. One or more commands are executed repeatedly while a condition remains true. Typically a counter object is initialized for controlling the loop, and then incremented within the while loop while certain commands are executed for each repetition. The loop ends when the while condition is false.</p>
<p><code>t = 0</code><br>
<code>while(t &lt; 7)&nbsp;{</code><br>
<code>print(t)</code><br>
<code>t = t+1</code><br>
<code>}</code></p>
</section>
<section id="blood-pressure-example-revisited" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="blood-pressure-example-revisited"><span class="header-section-number">12.3</span> Blood Pressure Example Revisited</h2>
<p>Earlier we dealt with a data set where diastolic and systolic blood pressure had been read into a single column separated. We learned how to extract the two blood pressures using the <code>strsplit</code> function. Now that we have discussed creating functions and programming, we will separate the two measurements for the entire data set. We begin by clearing up the workspace.</p>
<p><code>&gt; ls()</code></p>
<p><code>&gt; rm(list=ls())</code></p>
<p><code>&gt; dat = read.csv("linmod.csv", header=TRUE, na.strings=c("NA", 888, 999, "Not Reported"))</code></p>
<p>Extract a blood pressure for practice.</p>
<p><code>&gt; b = dat$bp[1]</code></p>
<p>Recall that the following commands successfully extracted the separated measurements.</p>
<p><code>&gt; ## Change to character.</code></p>
<p><code>&gt; b = as.character(b)</code></p>
<p><code>&gt; sep = strsplit(b, split="/")</code></p>
<p><code>&gt; ## Extract systolic blood pressure.</code></p>
<p><code>&gt; s = sep[[1]][1]</code></p>
<p><code>&gt; ## Extract diastolic blood pressure.</code></p>
<p><code>&gt; d = sep[[1]][2]</code></p>
<p><code>&gt; ## Convert to numeric.</code></p>
<p><code>&gt; s = as.numeric(s)</code></p>
<p><code>&gt; d = as.numeric(d)</code></p>
<p>Now we enclose the following commands in a function. We will name this function <code>extract.bp</code>.</p>
<p><code>&gt; extract.bp = function(x) {</code></p>
<p><code>&gt; x = as.character(x)</code></p>
<p><code>&gt; sep = strsplit(x, split="/")</code></p>
<p><code>&gt; s = as.numeric(sep[[1]][1])</code></p>
<p><code>&gt; d = as.numeric(sep[[1]][2])</code></p>
<p><code>&gt; return(c(s,d))</code></p>
<p><code>&gt; }</code></p>
<p>Type <code>extract.bp</code> at the command line to verify the creation of the function was successful.</p>
<p><code>&gt; extract.bp</code></p>
<p>Now let’s experiment to see if our function works.</p>
<p><code>&gt; b</code></p>
<p><code>&gt; extract.bp(b)</code></p>
<p>The following code uses a loop to extract the blood pressures for each variable in the data set.</p>
<p><code>&gt; ## Number of rows in the data set.</code></p>
<p><code>&gt; n = dim(dat)[1]</code></p>
<p><code>&gt; ## Set up empty numeric vectors to store two blood pressures.</code></p>
<p><code>&gt; systolic = numeric(n)</code></p>
<p><code>&gt; diastolic = numeric(n)</code></p>
<p><code>&gt; ## Loop over the rows and extract.</code></p>
<p><code>&gt; for (j in 1:n){</code></p>
<p><code>&gt; out = extract.bp(dat$bp[j])</code></p>
<p><code>&gt; systolic[j] = out[1]</code></p>
<p><code>&gt; diastolic[j] = out[2]</code></p>
<p><code>&gt; }</code></p>
<p><code>&gt; systolic</code></p>
<p><code>&gt; diastolic</code></p>
</section>
<section id="the-apply-function" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="the-apply-function"><span class="header-section-number">12.4</span> The <code>apply</code> Function</h2>
<p>The <code>apply</code> function performs a function on each row or column of a matrix. (There are other *apply functions for other situations.) First create a couple matrices to play with. In addition to the <code>matrix</code> function, <code>rbind</code> (or <code>cbind</code>) can be used to create matrices. For example,</p>
<p><code>&gt; c1 = c(2, 9, 3)</code></p>
<p><code>&gt; c2 = c(12, 1, 5)</code></p>
<p><code>&gt; M2 = cbind(c1, c2)</code></p>
<p><code>&gt; M2</code></p>
<p><code>&gt; apply(M2, 2, mean)</code></p>
<p>In the example above, <code>apply</code> took three arguments:</p>
<ol type="1">
<li><p>The first argument, “M2” is the matrix</p></li>
<li><p>The second argument, “2”, is an index indicating the function is applied separately for each column, a value of “1” would apply the function on each row</p></li>
<li><p>The last argument is the function that is applied</p></li>
</ol>
<p>If you were to just type <code>mean(M2)</code>, the mean would be computed over the entire matrix.</p>
<p><code>&gt; mean(M2)</code></p>


</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p><span class="math inline">\(\beta_i\)</span> is an additive effect, and <span class="math inline">\(e^{\beta_i}\)</span> is a multiplicative effect. For example, if <span class="math inline">\(\beta_i = 0.38\)</span>, we would estimate that the log odds of success increases by 0.38 for every unit increase in <span class="math inline">\(X_i\)</span>. If <span class="math inline">\(e^{\beta_i} = 1.46\)</span>, we would estimate that the odds of success increases by 46 <em>percent</em> for every unit increase in <span class="math inline">\(X_i\)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link  aria-label=" preface"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>